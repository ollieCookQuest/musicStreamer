{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/lib/db.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = global as unknown as { prisma: PrismaClient };\n\nexport const prisma =\n  globalForPrisma.prisma ||\n  new PrismaClient({\n    log: [\"query\"],\n  });\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,sMAAY,CAAC;IACf,KAAK;QAAC;KAAQ;AAChB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/lib/sonos.ts"],"sourcesContent":["import { prisma } from \"./db\";\n\nconst CLIENT_ID = process.env.SONOS_CLIENT_ID;\nconst CLIENT_SECRET = process.env.SONOS_CLIENT_SECRET;\nconst CALLBACK_URL = process.env.SONOS_CALLBACK_URL;\n\nconst BASE_URL = \"https://api.ws.sonos.com/control/api/v1\";\nconst AUTH_URL = \"https://api.sonos.com/login/v3/oauth\";\nconst TOKEN_URL = \"https://api.sonos.com/login/v3/oauth/access\";\n\nexport function getAuthUrl() {\n  const params = new URLSearchParams({\n    client_id: CLIENT_ID!,\n    response_type: \"code\",\n    state: \"sonos-auth\",\n    scope: \"playback-control-all\",\n    redirect_uri: CALLBACK_URL!,\n  });\n  return `${AUTH_URL}?${params.toString()}`;\n}\n\nexport async function exchangeCode(code: string) {\n  const auth = Buffer.from(`${CLIENT_ID}:${CLIENT_SECRET}`).toString(\"base64\");\n  \n  const response = await fetch(TOKEN_URL, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\n      Authorization: `Basic ${auth}`,\n    },\n    body: new URLSearchParams({\n      grant_type: \"authorization_code\",\n      code,\n      redirect_uri: CALLBACK_URL!,\n    }),\n  });\n\n  if (!response.ok) {\n    const error = await response.text();\n    throw new Error(`Failed to exchange code: ${error}`);\n  }\n\n  const data = await response.json();\n  \n  await prisma.account.create({\n    data: {\n      service: \"sonos\",\n      accessToken: data.access_token,\n      refreshToken: data.refresh_token,\n      expiresAt: new Date(Date.now() + data.expires_in * 1000),\n    },\n  });\n\n  return data;\n}\n\nexport async function getValidToken() {\n  const account = await prisma.account.findFirst({\n    where: { service: \"sonos\" },\n    orderBy: { createdAt: \"desc\" },\n  });\n\n  if (!account) return null;\n\n  if (account.expiresAt.getTime() > Date.now() + 60000) {\n    return account.accessToken;\n  }\n\n  const auth = Buffer.from(`${CLIENT_ID}:${CLIENT_SECRET}`).toString(\"base64\");\n  const response = await fetch(TOKEN_URL, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\n      Authorization: `Basic ${auth}`,\n    },\n    body: new URLSearchParams({\n      grant_type: \"refresh_token\",\n      refresh_token: account.refreshToken,\n    }),\n  });\n\n  if (!response.ok) {\n    throw new Error(\"Failed to refresh token\");\n  }\n\n  const data = await response.json();\n\n  const updated = await prisma.account.update({\n    where: { id: account.id },\n    data: {\n      accessToken: data.access_token,\n      refreshToken: data.refresh_token || account.refreshToken,\n      expiresAt: new Date(Date.now() + data.expires_in * 1000),\n    },\n  });\n\n  return updated.accessToken;\n}\n\nasync function sonosRequest(endpoint: string, options: RequestInit = {}) {\n  const token = await getValidToken();\n  if (!token) throw new Error(\"No valid token\");\n\n  const response = await fetch(`${BASE_URL}${endpoint}`, {\n    ...options,\n    headers: {\n      ...options.headers,\n      Authorization: `Bearer ${token}`,\n      \"Content-Type\": \"application/json\",\n    },\n  });\n\n  if (!response.ok) {\n    const error = await response.text();\n    throw new Error(`Sonos API error: ${error}`);\n  }\n\n  return response.json();\n}\n\nexport async function fetchHouseholds() {\n  return sonosRequest(\"/households\");\n}\n\nexport async function fetchGroups(householdId: string) {\n  return sonosRequest(`/households/${householdId}/groups`);\n}\n\nexport async function fetchFavorites(householdId: string) {\n  return sonosRequest(`/households/${householdId}/favorites`);\n}\n\nexport async function getPlaybackStatus(groupId: string) {\n  return sonosRequest(`/groups/${groupId}/playback`);\n}\n\nexport async function getPlaybackMetadata(groupId: string) {\n  return sonosRequest(`/groups/${groupId}/playbackMetadata`);\n}\n\nexport async function loadFavorite(groupId: string, favoriteId: string) {\n  return sonosRequest(`/groups/${groupId}/favorites`, {\n    method: \"POST\",\n    body: JSON.stringify({ favoriteId, action: \"replace\" }),\n  });\n}\n\nexport async function sendControl(groupId: string, command: \"play\" | \"pause\" | \"skipToNextTrack\" | \"skipToPreviousTrack\") {\n  return sonosRequest(`/groups/${groupId}/playback/${command}`, {\n    method: \"POST\",\n  });\n}\n\nexport async function getVolume(groupId: string) {\n  return sonosRequest(`/groups/${groupId}/groupVolume`);\n}\n\nexport async function setVolume(groupId: string, volume: number) {\n  return sonosRequest(`/groups/${groupId}/groupVolume`, {\n    method: \"POST\",\n    body: JSON.stringify({ volume }),\n  });\n}\n\nexport async function seek(groupId: string, positionMillis: number) {\n  return sonosRequest(`/groups/${groupId}/playback/seek`, {\n    method: \"POST\",\n    body: JSON.stringify({ positionMillis }),\n  });\n}\n\nexport async function getMusicServiceAccounts(householdId: string) {\n  return sonosRequest(`/households/${householdId}/musicServiceAccounts`);\n}\n\nexport async function searchMusicService(householdId: string, accountId: string, term: string, serviceId: string) {\n  // Try different search endpoint structures\n  try {\n    return await sonosRequest(`/households/${householdId}/musicServiceAccounts/${accountId}/search`, {\n      method: \"POST\",\n      body: JSON.stringify({\n        term,\n        serviceId,\n      }),\n    });\n  } catch (error: any) {\n    // Try alternative structure\n    try {\n      return await sonosRequest(`/households/${householdId}/musicServices/${serviceId}/search`, {\n        method: \"POST\",\n        body: JSON.stringify({\n          term,\n          accountId,\n        }),\n      });\n    } catch (error2: any) {\n      throw new Error(\"Search not available in Control API\");\n    }\n  }\n}\n\nexport async function getMusicServiceMetadata(householdId: string, accountId: string, itemId: string, serviceId: string) {\n  return sonosRequest(`/households/${householdId}/musicServiceAccounts/${accountId}/getMetadata`, {\n    method: \"POST\",\n    body: JSON.stringify({\n      itemId: {\n        _objectType: \"universalMusicObjectId\",\n        serviceId,\n        objectId: itemId,\n        accountId,\n      },\n    }),\n  });\n}\n\n// Try to browse using search with empty term or common categories\nexport async function browseMusicService(householdId: string, musicServiceId: string, accountId: string, containerId?: string) {\n  // Try different endpoint structures\n  let endpoint;\n  \n  if (containerId) {\n    // Try with container ID\n    endpoint = `/households/${householdId}/musicServiceAccounts/${accountId}/containers/${containerId}`;\n  } else {\n    // Try root containers - different possible structures\n    // Structure 1: Using musicServiceAccounts\n    endpoint = `/households/${householdId}/musicServiceAccounts/${accountId}/containers`;\n  }\n  \n  try {\n    return await sonosRequest(endpoint);\n  } catch (error: any) {\n    // If that fails, try alternative structure with serviceId\n    try {\n      const altEndpoint = containerId\n        ? `/households/${householdId}/musicServices/${musicServiceId}/containers/${containerId}`\n        : `/households/${householdId}/musicServices/${musicServiceId}/containers`;\n      return await sonosRequest(altEndpoint);\n    } catch (error2: any) {\n      // If both fail, return common Spotify categories as fallback\n      console.log(\"Browse endpoint not available, using fallback\");\n      if (!containerId) {\n        return {\n          containers: [\n            { \n              name: \"Your Library\", \n              type: \"library\", \n              id: { objectId: \"spotify:user-library\", serviceId: musicServiceId, accountId },\n              _objectType: \"container\"\n            },\n            { \n              name: \"Your Playlists\", \n              type: \"playlists\", \n              id: { objectId: \"spotify:user-playlists\", serviceId: musicServiceId, accountId },\n              _objectType: \"container\"\n            },\n            { \n              name: \"Recently Played\", \n              type: \"recent\", \n              id: { objectId: \"spotify:recently-played\", serviceId: musicServiceId, accountId },\n              _objectType: \"container\"\n            },\n            { \n              name: \"Search\", \n              type: \"search\", \n              id: { objectId: \"search\", serviceId: musicServiceId, accountId },\n              _objectType: \"container\"\n            },\n          ],\n        };\n      }\n      return { containers: [], items: [] };\n    }\n  }\n}\n\nexport async function playItem(groupId: string, itemId: string, serviceId: string, accountId: string, action: \"replace\" | \"addNext\" | \"addToEnd\" = \"replace\") {\n  return sonosRequest(`/groups/${groupId}/playback/playItem`, {\n    method: \"POST\",\n    body: JSON.stringify({\n      itemId: {\n        _objectType: \"universalMusicObjectId\",\n        serviceId,\n        objectId: itemId,\n        accountId,\n      },\n      action,\n    }),\n  });\n}\n\nexport async function addToFavorites(householdId: string, itemId: string, serviceId: string, accountId: string, name: string) {\n  return sonosRequest(`/households/${householdId}/favorites`, {\n    method: \"POST\",\n    body: JSON.stringify({\n      itemId: {\n        _objectType: \"universalMusicObjectId\",\n        serviceId,\n        objectId: itemId,\n        accountId,\n      },\n      name,\n    }),\n  });\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 403, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/app/api/sonos/library/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { fetchHouseholds, browseMusicService, getMusicServiceAccounts } from \"@/lib/sonos\";\n\nexport async function GET(request: NextRequest) {\n  const { searchParams } = new URL(request.url);\n  const accountId = searchParams.get(\"accountId\");\n  const containerId = searchParams.get(\"containerId\");\n\n  try {\n    const householdsData = await fetchHouseholds();\n    const households = householdsData.households;\n    if (!households || households.length === 0) {\n      return NextResponse.json({ error: \"No households found\" }, { status: 404 });\n    }\n\n    const householdId = households[0].id;\n\n    if (!accountId) {\n      // Return available music services\n      try {\n        const accounts = await getMusicServiceAccounts(householdId);\n        return NextResponse.json({ services: accounts.musicServiceAccounts || [] });\n      } catch (error) {\n        // Fallback: extract from favorites/playback\n        return NextResponse.json({ services: [] });\n      }\n    }\n\n    // Get service ID from account\n    const accounts = await getMusicServiceAccounts(householdId);\n    const account = accounts.musicServiceAccounts?.find((acc: any) => acc.id === accountId);\n    const serviceId = account?.serviceId || \"9\"; // Default to Spotify\n\n    // Browse containers using Sonos API\n    const browseResult = await browseMusicService(householdId, serviceId, accountId, containerId || undefined);\n    \n    return NextResponse.json({\n      containers: browseResult.containers || [],\n      items: browseResult.items || [],\n    });\n  } catch (error: any) {\n    console.error(\"Library API error:\", error);\n    return NextResponse.json({ \n      error: \"Failed to fetch library\", \n      details: error.message \n    }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;IAC5C,MAAM,YAAY,aAAa,GAAG,CAAC;IACnC,MAAM,cAAc,aAAa,GAAG,CAAC;IAErC,IAAI;QACF,MAAM,iBAAiB,MAAM,IAAA,wIAAe;QAC5C,MAAM,aAAa,eAAe,UAAU;QAC5C,IAAI,CAAC,cAAc,WAAW,MAAM,KAAK,GAAG;YAC1C,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,MAAM,cAAc,UAAU,CAAC,EAAE,CAAC,EAAE;QAEpC,IAAI,CAAC,WAAW;YACd,kCAAkC;YAClC,IAAI;gBACF,MAAM,WAAW,MAAM,IAAA,gJAAuB,EAAC;gBAC/C,OAAO,gJAAY,CAAC,IAAI,CAAC;oBAAE,UAAU,SAAS,oBAAoB,IAAI,EAAE;gBAAC;YAC3E,EAAE,OAAO,OAAO;gBACd,4CAA4C;gBAC5C,OAAO,gJAAY,CAAC,IAAI,CAAC;oBAAE,UAAU,EAAE;gBAAC;YAC1C;QACF;QAEA,8BAA8B;QAC9B,MAAM,WAAW,MAAM,IAAA,gJAAuB,EAAC;QAC/C,MAAM,UAAU,SAAS,oBAAoB,EAAE,KAAK,CAAC,MAAa,IAAI,EAAE,KAAK;QAC7E,MAAM,YAAY,SAAS,aAAa,KAAK,qBAAqB;QAElE,oCAAoC;QACpC,MAAM,eAAe,MAAM,IAAA,2IAAkB,EAAC,aAAa,WAAW,WAAW,eAAe;QAEhG,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,YAAY,aAAa,UAAU,IAAI,EAAE;YACzC,OAAO,aAAa,KAAK,IAAI,EAAE;QACjC;IACF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,OAAO;YACP,SAAS,MAAM,OAAO;QACxB,GAAG;YAAE,QAAQ;QAAI;IACnB;AACF"}}]
}