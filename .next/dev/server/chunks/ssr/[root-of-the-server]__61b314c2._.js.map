{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/components/sonos-provider.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { createContext, useContext, useEffect, useState, useRef, useCallback } from \"react\";\n\ninterface SonosContextType {\n  households: any[];\n  groups: any[];\n  favorites: any[];\n  currentGroup: any | null;\n  playbackState: any | null;\n  volume: number;\n  isExpanded: boolean;\n  currentPage: string;\n  selectedZoneIds: string[];\n  setIsExpanded: (expanded: boolean) => void;\n  setCurrentPage: (page: string) => void;\n  setCurrentGroup: (group: any) => void;\n  setVolume: (volume: number) => Promise<void>;\n  setSelectedZoneIds: (zoneIds: string[]) => void;\n  toggleZone: (zoneId: string) => void;\n  refreshState: () => Promise<void>;\n}\n\nconst SonosContext = createContext<SonosContextType | undefined>(undefined);\n\n// Helper to compare arrays/objects for equality\nfunction deepEqual(a: any, b: any): boolean {\n  if (a === b) return true;\n  if (a == null || b == null) return false;\n  if (typeof a !== \"object\" || typeof b !== \"object\") return false;\n  \n  const keysA = Object.keys(a);\n  const keysB = Object.keys(b);\n  \n  if (keysA.length !== keysB.length) return false;\n  \n  for (const key of keysA) {\n    if (!keysB.includes(key)) return false;\n    if (!deepEqual(a[key], b[key])) return false;\n  }\n  \n  return true;\n}\n\nexport function SonosProvider({ children }: { children: React.ReactNode }) {\n  const [households, setHouseholds] = useState<any[]>([]);\n  const [groups, setGroups] = useState<any[]>([]);\n  const [favorites, setFavorites] = useState<any[]>([]);\n  const [currentGroup, setCurrentGroup] = useState<any | null>(null);\n  const [playbackState, setPlaybackState] = useState<any | null>(null);\n  const [volume, setVolumeState] = useState<number>(50);\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [currentPage, setCurrentPage] = useState<string>(\"Feed\");\n  const [selectedZoneIds, setSelectedZoneIds] = useState<string[]>([]);\n  \n  const isRefreshingRef = useRef(false);\n  const currentGroupIdRef = useRef<string | null>(null);\n  const currentGroupRef = useRef<any | null>(null);\n  const prevStateRef = useRef<{\n    households: any[];\n    groups: any[];\n    favorites: any[];\n    playbackState: any | null;\n    volume: number;\n  }>({\n    households: [],\n    groups: [],\n    favorites: [],\n    playbackState: null,\n    volume: 50,\n  });\n\n  // Keep ref in sync with state\n  useEffect(() => {\n    currentGroupRef.current = currentGroup;\n  }, [currentGroup]);\n\n  // Save current zone preference\n  const saveZonePreference = useCallback(async (zoneId: string) => {\n    try {\n      await fetch(\"/api/preferences\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ key: \"currentZoneId\", value: zoneId }),\n      });\n    } catch (error) {\n      console.error(\"Failed to save zone preference:\", error);\n    }\n  }, []);\n\n  // Save selected zones preference\n  const saveSelectedZonesPreference = useCallback(async (zoneIds: string[]) => {\n    try {\n      await fetch(\"/api/preferences\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ \n          key: \"selectedZoneIds\", \n          value: JSON.stringify(zoneIds) \n        }),\n      });\n    } catch (error) {\n      console.error(\"Failed to save selected zones preference:\", error);\n    }\n  }, []);\n\n  // Load saved zone preference\n  const loadZonePreference = useCallback(async (): Promise<string | null> => {\n    try {\n      const res = await fetch(\"/api/preferences?key=currentZoneId\");\n      if (res.ok) {\n        const data = await res.json();\n        return data.value;\n      }\n    } catch (error) {\n      console.error(\"Failed to load zone preference:\", error);\n    }\n    return null;\n  }, []);\n\n  // Load saved selected zones preference\n  const loadSelectedZonesPreference = useCallback(async (): Promise<string[]> => {\n    try {\n      const res = await fetch(\"/api/preferences?key=selectedZoneIds\");\n      if (res.ok) {\n        const data = await res.json();\n        if (data.value) {\n          return JSON.parse(data.value);\n        }\n      }\n    } catch (error) {\n      console.error(\"Failed to load selected zones preference:\", error);\n    }\n    return [];\n  }, []);\n\n  const refreshState = useCallback(async () => {\n    // Prevent overlapping refresh calls\n    if (isRefreshingRef.current) return;\n    isRefreshingRef.current = true;\n\n    try {\n      const res = await fetch(\"/api/sonos/state\");\n      if (!res.ok) return;\n      const data = await res.json();\n      \n      // Only update households if changed\n      if (!deepEqual(prevStateRef.current.households, data.households || [])) {\n        setHouseholds(data.households || []);\n        prevStateRef.current.households = data.households || [];\n      }\n      \n      // Stable sort for groups to prevent jumping UI\n      const sortedGroups = (data.groups || []).sort((a: any, b: any) => \n        a.name.localeCompare(b.name)\n      );\n      \n      // Only update groups if changed\n      if (!deepEqual(prevStateRef.current.groups, sortedGroups)) {\n        setGroups(sortedGroups);\n        prevStateRef.current.groups = sortedGroups;\n      }\n      \n      // Stable sort for favorites\n      const sortedFavorites = (data.favorites || []).sort((a: any, b: any) => \n        a.name.localeCompare(b.name)\n      );\n      \n      // Only update favorites if changed\n      if (!deepEqual(prevStateRef.current.favorites, sortedFavorites)) {\n        setFavorites(sortedFavorites);\n        prevStateRef.current.favorites = sortedFavorites;\n      }\n      \n      const currentGroupValue = currentGroupRef.current;\n      if (!currentGroupValue && data.groups?.length > 0) {\n        // Try to load saved zone preferences first\n        const savedZoneId = await loadZonePreference();\n        const savedSelectedZoneIds = await loadSelectedZonesPreference();\n        \n        let targetGroup = null;\n        \n        // Try to restore saved selected zones if they exist\n        if (savedSelectedZoneIds.length > 0) {\n          // Filter to only include zones that still exist\n          const validZoneIds = savedSelectedZoneIds.filter((id: string) => \n            data.groups.some((g: any) => g.id === id)\n          );\n          \n          if (validZoneIds.length > 0) {\n            setSelectedZoneIds(validZoneIds);\n            // Set current group to first selected zone\n            targetGroup = data.groups.find((g: any) => g.id === validZoneIds[0]);\n          }\n        }\n        \n        // If no saved selected zones, try saved current zone\n        if (!targetGroup && savedZoneId) {\n          targetGroup = data.groups.find((g: any) => g.id === savedZoneId);\n        }\n        \n        // Use saved zone if found, otherwise use first group\n        const firstGroup = targetGroup || data.groups[0];\n        setCurrentGroup(firstGroup);\n        // Initialize selectedZoneIds if not already set from saved preference\n        if (savedSelectedZoneIds.length === 0) {\n          setSelectedZoneIds([firstGroup.id]);\n        }\n      } else if (currentGroupValue) {\n        // Update current group state from fresh groups list\n        const updatedGroup = data.groups.find((g: any) => g.id === currentGroupValue.id);\n        if (updatedGroup && !deepEqual(currentGroupValue, updatedGroup)) {\n          setCurrentGroup(updatedGroup);\n          // Ensure selectedZoneIds includes the current group\n          if (!selectedZoneIds.includes(updatedGroup.id)) {\n            setSelectedZoneIds([updatedGroup.id]);\n          }\n        } else if (!updatedGroup) {\n          // Current group no longer exists, try to load saved preference or use first group\n          const savedZoneId = await loadZonePreference();\n          let targetGroup = null;\n          \n          if (savedZoneId) {\n            targetGroup = data.groups.find((g: any) => g.id === savedZoneId);\n          }\n          \n          const fallbackGroup = targetGroup || data.groups[0];\n          if (fallbackGroup) {\n            setCurrentGroup(fallbackGroup);\n            setSelectedZoneIds([fallbackGroup.id]);\n          }\n        }\n      }\n\n      // Always fetch playback and volume if we have a group\n      const groupId = currentGroupValue?.id;\n      if (groupId) {\n        // Update group ID ref if changed\n        if (groupId !== currentGroupIdRef.current) {\n          currentGroupIdRef.current = groupId;\n        }\n        \n        const [pbRes, volRes] = await Promise.all([\n          fetch(`/api/sonos/playback?groupId=${groupId}`),\n          fetch(`/api/sonos/volume?groupId=${groupId}`)\n        ]);\n        \n        // Handle ERROR_RESOURCE_GONE - group was modified/ungrouped\n        if (pbRes.status === 410 || volRes.status === 410) {\n          // Group no longer exists, refresh groups and find new current group\n          const stateRes = await fetch(\"/api/sonos/state\");\n          if (stateRes.ok) {\n            const stateData = await stateRes.json();\n            const updatedGroups = (stateData.groups || []).sort((a: any, b: any) => \n              a.name.localeCompare(b.name)\n            );\n            setGroups(updatedGroups);\n            \n            // Try to find group by name or use first available\n            const oldGroupName = currentGroupValue?.name;\n            const newGroup = oldGroupName \n              ? updatedGroups.find((g: any) => g.name === oldGroupName)\n              : updatedGroups[0];\n            \n            if (newGroup) {\n              setCurrentGroup(newGroup);\n              // Update selectedZoneIds to match new group\n              if (selectedZoneIds.includes(currentGroupValue.id)) {\n                setSelectedZoneIds([newGroup.id]);\n              }\n            } else if (updatedGroups.length > 0) {\n              setCurrentGroup(updatedGroups[0]);\n              setSelectedZoneIds([updatedGroups[0].id]);\n            }\n          }\n          return; // Exit early, will refresh on next poll\n        }\n        \n        if (pbRes.ok) {\n          const pbData = await pbRes.json();\n          // Always update playback state (don't check for changes to ensure UI updates)\n          setPlaybackState(pbData);\n          prevStateRef.current.playbackState = pbData;\n        }\n        \n        if (volRes.ok) {\n          const volData = await volRes.json();\n          const newVolume = volData.volume || 50;\n          // Always update volume state\n          setVolumeState(newVolume);\n          prevStateRef.current.volume = newVolume;\n        }\n      }\n    } catch (err) {\n      console.error(\"Failed to fetch Sonos state\", err);\n    } finally {\n      isRefreshingRef.current = false;\n    }\n  }, [loadZonePreference, loadSelectedZonesPreference]);\n\n  const setVolume = async (newVolume: number) => {\n    if (!currentGroup) return;\n    setVolumeState(newVolume);\n    const res = await fetch(`/api/sonos/control?groupId=${currentGroup.id}&volume=${newVolume}`, { method: \"POST\" });\n    if (res.status === 410) {\n      // Group no longer exists, refresh state\n      await refreshState();\n    }\n  };\n\n  // Initial load\n  useEffect(() => {\n    refreshState();\n  }, []);\n\n  // Set up polling interval (independent of state changes)\n  useEffect(() => {\n    // Poll every 10 seconds - less frequent updates\n    const interval = setInterval(() => {\n      refreshState();\n    }, 10000);\n    return () => clearInterval(interval);\n  }, []);\n\n  // Refresh when group changes\n  useEffect(() => {\n    if (currentGroup?.id) {\n      refreshState();\n    }\n  }, [currentGroup?.id]);\n\n  // Keep selected zones in sync with current group and save preferences\n  useEffect(() => {\n    if (currentGroup?.id) {\n      // If no zones selected, or current group is not in selected zones, update it\n      if (selectedZoneIds.length === 0 || !selectedZoneIds.includes(currentGroup.id)) {\n        setSelectedZoneIds([currentGroup.id]);\n      }\n      // Save zone preference to database\n      saveZonePreference(currentGroup.id);\n    }\n  }, [currentGroup?.id, saveZonePreference]);\n\n  // Save selected zones preference whenever it changes\n  useEffect(() => {\n    if (selectedZoneIds.length > 0) {\n      saveSelectedZonesPreference(selectedZoneIds);\n    }\n  }, [selectedZoneIds, saveSelectedZonesPreference]);\n\n  const toggleZone = (zoneId: string) => {\n    setSelectedZoneIds(prev => {\n      if (prev.includes(zoneId)) {\n        return prev.filter(id => id !== zoneId);\n      } else {\n        return [...prev, zoneId];\n      }\n    });\n  };\n\n  return (\n    <SonosContext.Provider\n      value={{\n        households,\n        groups,\n        favorites,\n        currentGroup,\n        playbackState,\n        volume,\n        isExpanded,\n        currentPage,\n        selectedZoneIds,\n        setIsExpanded,\n        setCurrentPage,\n        setCurrentGroup,\n        setVolume,\n        setSelectedZoneIds,\n        toggleZone,\n        refreshState,\n      }}\n    >\n      {children}\n    </SonosContext.Provider>\n  );\n}\n\nexport function useSonos() {\n  const context = useContext(SonosContext);\n  if (context === undefined) {\n    throw new Error(\"useSonos must be used within a SonosProvider\");\n  }\n  return context;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 374, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/components/device-provider.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { createContext, useContext, useEffect, useState } from \"react\";\nimport { cn } from \"@/lib/utils\";\n\ntype DeviceType = \"theWall\" | \"theDesk\" | null;\n\ninterface DeviceContextType {\n  deviceType: DeviceType;\n  isLoading: boolean;\n  deviceConfig: {\n    name: string;\n    screenSize: string;\n    resolution: string;\n    orientation: \"landscape\" | \"portrait\";\n  } | null;\n  // Utility function to get device-specific classes\n  deviceClass: (classes: string | { [key: string]: string }) => string;\n}\n\nconst DeviceContext = createContext<DeviceContextType | undefined>(undefined);\n\nconst DEVICE_CONFIGS = {\n  theWall: {\n    name: \"TheWall\",\n    screenSize: \"10.1\\\"\",\n    resolution: \"1280×800\",\n    orientation: \"landscape\" as const,\n  },\n  theDesk: {\n    name: \"TheDesk\",\n    screenSize: \"10.1\\\"\",\n    resolution: \"1280×800\",\n    orientation: \"landscape\" as const,\n  },\n};\n\nexport function DeviceProvider({ children }: { children: React.ReactNode }) {\n  const [deviceType, setDeviceType] = useState<DeviceType>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    const loadDevice = async () => {\n      try {\n        const res = await fetch(\"/api/preferences?key=deviceType\");\n        if (res.ok) {\n          const data = await res.json();\n          if (data.value && (data.value === \"theWall\" || data.value === \"theDesk\")) {\n            setDeviceType(data.value);\n          }\n        }\n      } catch (error) {\n        console.error(\"Failed to load device preference:\", error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    loadDevice();\n  }, []);\n\n  const deviceConfig = deviceType ? DEVICE_CONFIGS[deviceType] : null;\n\n  // Utility function to get device-specific classes\n  const deviceClass = (classes: string | { [key: string]: string }): string => {\n    if (!deviceType) return typeof classes === \"string\" ? classes : \"\";\n    \n    if (typeof classes === \"string\") {\n      // If it's a string, return as-is (device-specific overrides can be added via CSS)\n      return classes;\n    }\n    \n    // If it's an object, return the class for the current device\n    return classes[deviceType] || classes.default || \"\";\n  };\n\n  // Apply device-specific class to html element for CSS targeting\n  useEffect(() => {\n    if (deviceType) {\n      document.documentElement.setAttribute(\"data-device\", deviceType);\n    } else {\n      document.documentElement.removeAttribute(\"data-device\");\n    }\n  }, [deviceType]);\n\n  return (\n    <DeviceContext.Provider value={{ deviceType, isLoading, deviceConfig, deviceClass }}>\n      {children}\n    </DeviceContext.Provider>\n  );\n}\n\nexport function useDevice() {\n  const context = useContext(DeviceContext);\n  if (context === undefined) {\n    throw new Error(\"useDevice must be used within a DeviceProvider\");\n  }\n  return context;\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AAFA;;;AAoBA,MAAM,8BAAgB,IAAA,sNAAa,EAAgC;AAEnE,MAAM,iBAAiB;IACrB,SAAS;QACP,MAAM;QACN,YAAY;QACZ,YAAY;QACZ,aAAa;IACf;IACA,SAAS;QACP,MAAM;QACN,YAAY;QACZ,YAAY;QACZ,aAAa;IACf;AACF;AAEO,SAAS,eAAe,EAAE,QAAQ,EAAiC;IACxE,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAa;IACzD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAE3C,IAAA,kNAAS,EAAC;QACR,MAAM,aAAa;YACjB,IAAI;gBACF,MAAM,MAAM,MAAM,MAAM;gBACxB,IAAI,IAAI,EAAE,EAAE;oBACV,MAAM,OAAO,MAAM,IAAI,IAAI;oBAC3B,IAAI,KAAK,KAAK,IAAI,CAAC,KAAK,KAAK,KAAK,aAAa,KAAK,KAAK,KAAK,SAAS,GAAG;wBACxE,cAAc,KAAK,KAAK;oBAC1B;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,qCAAqC;YACrD,SAAU;gBACR,aAAa;YACf;QACF;QACA;IACF,GAAG,EAAE;IAEL,MAAM,eAAe,aAAa,cAAc,CAAC,WAAW,GAAG;IAE/D,kDAAkD;IAClD,MAAM,cAAc,CAAC;QACnB,IAAI,CAAC,YAAY,OAAO,OAAO,YAAY,WAAW,UAAU;QAEhE,IAAI,OAAO,YAAY,UAAU;YAC/B,kFAAkF;YAClF,OAAO;QACT;QAEA,6DAA6D;QAC7D,OAAO,OAAO,CAAC,WAAW,IAAI,QAAQ,OAAO,IAAI;IACnD;IAEA,gEAAgE;IAChE,IAAA,kNAAS,EAAC;QACR,IAAI,YAAY;YACd,SAAS,eAAe,CAAC,YAAY,CAAC,eAAe;QACvD,OAAO;YACL,SAAS,eAAe,CAAC,eAAe,CAAC;QAC3C;IACF,GAAG;QAAC;KAAW;IAEf,qBACE,8OAAC,cAAc,QAAQ;QAAC,OAAO;YAAE;YAAY;YAAW;YAAc;QAAY;kBAC/E;;;;;;AAGP;AAEO,SAAS;IACd,MAAM,UAAU,IAAA,mNAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT"}},
    {"offset": {"line": 467, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/node_modules/next/src/server/route-modules/app-page/module.compiled.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK"],"mappings":"AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;KAElC;IACL,IAAIF,QAAQC,GAAG,CAACK,yBAAyB,EAAE;;SAcpC;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1C,IAAIP,QAAQC,GAAG,CAACO,SAAS,eAAE;gBACzBL,OAAOC,OAAO,GAAGC,QAAQ;YAC3B,OAAO;;QAGT,OAAO;;IAOT;AACF","ignoreList":[0]}},
    {"offset": {"line": 486, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0]}},
    {"offset": {"line": 491, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n"],"names":["module","exports","require","vendored","React"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,KAAK","ignoreList":[0]}}]
}