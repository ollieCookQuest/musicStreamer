{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,sKAAO,EAAC,IAAA,6IAAI,EAAC;AACtB"}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground shadow hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2\",\n        sm: \"h-8 rounded-md px-3 text-xs\",\n        lg: \"h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,iBAAiB,IAAA,uKAAG,EACxB,ySACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,mNAAgB,CAC7B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,wKAAI,GAAG;IAC9B,qBACE,8OAAC;QACC,WAAW,IAAA,yHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,OAAO,WAAW,GAAG"}},
    {"offset": {"line": 79, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/components/dashboard/zone-selector.tsx"],"sourcesContent":["\"use client\";\n\nimport { useSonos } from \"@/components/sonos-provider\";\nimport { Button } from \"@/components/ui/button\";\nimport { Compass, Layout, Waves, Check, Link2 } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { useState } from \"react\";\n\nconst NAV_ITEMS = [\n  { icon: Compass, label: \"Feed\", page: \"Feed\" },\n  { icon: Layout, label: \"Library\", page: \"Library\" },\n];\n\nexport function ZoneSelector({ isCollapsed }: { isCollapsed: boolean }) {\n  const { \n    groups, \n    currentGroup, \n    setCurrentGroup, \n    currentPage, \n    setCurrentPage,\n    selectedZoneIds,\n    toggleZone,\n    setSelectedZoneIds,\n    refreshState,\n  } = useSonos();\n  const [isMultiSelectMode, setIsMultiSelectMode] = useState(false);\n\n  const handleGroupZones = async () => {\n    if (selectedZoneIds.length < 2) return;\n    \n    try {\n      console.log(\"Selected zone IDs:\", selectedZoneIds);\n      console.log(\"Groups:\", groups);\n\n      // Get player IDs from selected groups\n      // Groups contain player information - extract player IDs from group structure\n      const playerIds: string[] = [];\n      \n      for (const zoneId of selectedZoneIds) {\n        const group = groups.find((g: any) => g.id === zoneId);\n        console.log(`Processing zone ${zoneId}:`, group);\n        \n        if (group) {\n          // Method 1: Groups have a players array - extract player IDs\n          if (group.players && Array.isArray(group.players)) {\n            group.players.forEach((player: any) => {\n              // Player ID can be in different formats\n              const playerId = player.id || player.playerId || player.player?.id;\n              console.log(`Found player in group.players:`, player, `ID: ${playerId}`);\n              if (playerId && !playerIds.includes(playerId)) {\n                playerIds.push(playerId);\n              }\n            });\n          }\n          \n          // Method 2: Check for playerIds array directly\n          if (group.playerIds && Array.isArray(group.playerIds)) {\n            group.playerIds.forEach((pid: string) => {\n              console.log(`Found playerId in group.playerIds: ${pid}`);\n              if (pid && !playerIds.includes(pid)) {\n                playerIds.push(pid);\n              }\n            });\n          }\n          \n          // Method 3: Extract from group ID itself (group ID format: RINCON_xxx:timestamp)\n          // The group ID itself contains the player ID before the colon\n          if (group.id && group.id.includes(':')) {\n            const groupPlayerId = group.id.split(':')[0];\n            console.log(`Extracted player ID from group ID: ${groupPlayerId}`);\n            if (groupPlayerId && !playerIds.includes(groupPlayerId)) {\n              playerIds.push(groupPlayerId);\n            }\n          }\n          \n          // Method 4: If group has coordinator, use that\n          if (group.coordinatorId && !playerIds.includes(group.coordinatorId)) {\n            console.log(`Found coordinatorId: ${group.coordinatorId}`);\n            playerIds.push(group.coordinatorId);\n          }\n        }\n      }\n\n      if (playerIds.length === 0) {\n        console.error(\"No player IDs found for selected zones\");\n        return;\n      }\n\n      // Use the first selected group as the target group (this becomes the master group)\n      const targetGroupId = selectedZoneIds[0];\n      \n      console.log(\"Grouping zones from sidebar:\", { targetGroupId, playerIds });\n      \n      const res = await fetch(\"/api/sonos/groups\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          groupId: targetGroupId,\n          playerIds: playerIds,\n        }),\n      });\n\n      if (!res.ok) {\n        const errorData = await res.json().catch(() => ({ error: \"Failed to parse error response\" }));\n        console.error(\"Group API error:\", {\n          status: res.status,\n          statusText: res.statusText,\n          error: errorData\n        });\n        alert(`Failed to group zones: ${errorData.error || errorData.details || \"Unknown error\"}`);\n        return;\n      }\n\n      // After grouping, refresh state to get the new group structure\n      await refreshState();\n      \n      // Wait a bit for Sonos to update the group structure\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      // Update currentGroup to the newly grouped zone\n      await refreshState();\n      const updatedGroups = await fetch(\"/api/sonos/state\").then(r => r.json()).then(d => d.groups || []);\n      const groupedZone = updatedGroups.find((g: any) => g.id === targetGroupId);\n      if (groupedZone) {\n        // Set the grouped zone as current and selected\n        setCurrentGroup(groupedZone);\n        setSelectedZoneIds([targetGroupId]);\n        setIsMultiSelectMode(false);\n      }\n    } catch (error) {\n      console.error(\"Failed to group zones:\", error);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col h-full space-y-10 py-2\">\n      {/* Primary Navigation */}\n      <div className=\"space-y-4\">\n        <h3 className=\"text-[10px] font-black uppercase tracking-[0.4em] text-muted-foreground px-6\">\n          System\n        </h3>\n        <nav className=\"space-y-1 px-2\">\n          {NAV_ITEMS.map((item) => {\n            const isActive = currentPage === item.page;\n            return (\n              <Button\n                key={item.label}\n                variant=\"ghost\"\n                onClick={() => setCurrentPage(item.page)}\n                className={cn(\n                  \"w-full h-12 rounded-2xl transition-all duration-300 flex items-center justify-start px-4 group relative\",\n                  isActive \n                    ? \"bg-foreground/[0.05] text-foreground shadow-sm\" \n                    : \"text-muted-foreground hover:bg-foreground/[0.03] hover:text-foreground\"\n                )}\n              >\n                <item.icon className={cn(\n                  \"h-4 w-4 shrink-0 transition-transform duration-500\",\n                  isActive ? \"scale-110\" : \"group-hover:scale-110\"\n                )} />\n                <span className=\"font-black tracking-tight text-[11px] uppercase italic ml-4\">\n                  {item.label}\n                </span>\n              </Button>\n            );\n          })}\n        </nav>\n      </div>\n\n      {/* Room Selection - Architectural Design */}\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center justify-between px-6\">\n          <h3 className=\"text-[10px] font-black uppercase tracking-[0.4em] text-muted-foreground\">\n            Zones\n          </h3>\n          {!isMultiSelectMode ? (\n            <button\n              onClick={() => setIsMultiSelectMode(true)}\n              className=\"text-[8px] font-black uppercase tracking-[0.2em] text-primary hover:text-foreground transition-colors\"\n            >\n              Select\n            </button>\n          ) : (\n            <div className=\"flex items-center gap-2\">\n              {selectedZoneIds.length > 1 && (\n                <button\n                  onClick={handleGroupZones}\n                  className=\"text-[8px] font-black uppercase tracking-[0.2em] text-primary hover:text-foreground transition-colors flex items-center gap-1\"\n                >\n                  <Link2 className=\"h-3 w-3\" />\n                  Group\n                </button>\n              )}\n              <button\n                onClick={() => {\n                  setIsMultiSelectMode(false);\n                  setSelectedZoneIds([]);\n                }}\n                className=\"text-[8px] font-black uppercase tracking-[0.2em] text-muted-foreground hover:text-foreground transition-colors\"\n              >\n                Done\n              </button>\n            </div>\n          )}\n        </div>\n        \n        <div className=\"space-y-2 px-2\">\n          {groups.map((group) => {\n            const isPlaying = group.playbackState === \"PLAYBACK_STATE_PLAYING\";\n            const isActive = currentGroup?.id === group.id;\n            const isSelected = selectedZoneIds.includes(group.id);\n            \n            return (\n              <motion.button\n                key={group.id}\n                onClick={(e) => {\n                  if (isMultiSelectMode) {\n                    e.stopPropagation();\n                    toggleZone(group.id);\n                  } else {\n                    // When selecting a zone normally, set it as current group AND selected zone\n                    setCurrentGroup(group);\n                    setSelectedZoneIds([group.id]);\n                  }\n                }}\n                className={cn(\n                  \"w-full h-20 rounded-[2rem] transition-all duration-500 relative flex items-center px-4 overflow-hidden border\",\n                  isActive && !isMultiSelectMode\n                    ? \"bg-foreground/[0.06] text-foreground border-foreground/[0.1]\" \n                    : isSelected && isMultiSelectMode\n                    ? \"bg-primary/10 text-foreground border-primary/30\"\n                    : \"bg-transparent text-muted-foreground hover:bg-foreground/[0.02] border-transparent\"\n                )}\n                whileHover={{ scale: 1.01 }}\n                whileTap={{ scale: 0.99 }}\n              >\n                {/* Active State Indicator - Left Edge */}\n                {isActive && !isMultiSelectMode && (\n                  <motion.div \n                    layoutId=\"active-zone-indicator\"\n                    className=\"absolute left-0 top-0 bottom-0 w-0.5 bg-foreground\"\n                  />\n                )}\n                \n                {/* Selection Indicator in Multi-Select Mode */}\n                {isSelected && isMultiSelectMode && (\n                  <motion.div\n                    initial={{ scale: 0 }}\n                    animate={{ scale: 1 }}\n                    className=\"absolute top-2 right-2 h-6 w-6 rounded-full bg-primary flex items-center justify-center shadow-md\"\n                  >\n                    <Check className=\"h-3.5 w-3.5 text-primary-foreground\" />\n                  </motion.div>\n                )}\n\n                {/* Icon Container */}\n                <div className=\"relative shrink-0 flex items-center justify-center\">\n                  <div className={cn(\n                    \"h-12 w-12 rounded-full flex items-center justify-center transition-all duration-500\",\n                    isActive && !isMultiSelectMode\n                      ? \"bg-foreground shadow-lg\" \n                      : isSelected && isMultiSelectMode\n                      ? \"bg-primary shadow-lg\"\n                      : \"bg-foreground/[0.05]\"\n                  )}>\n                    <Waves className={cn(\n                      \"h-5 w-5 transition-colors duration-500\",\n                      (isActive && !isMultiSelectMode) || (isSelected && isMultiSelectMode)\n                        ? \"text-background\" \n                        : \"text-muted-foreground\"\n                    )} />\n                  </div>\n                  \n                  {/* Playing Indicator Dot */}\n                  {isPlaying && (\n                    <motion.div \n                      layoutId={`playing-dot-${group.id}`}\n                      className=\"absolute -top-0.5 -right-0.5 h-2.5 w-2.5 rounded-full bg-primary border-2 border-background shadow-sm\"\n                      animate={{ scale: [1, 1.2, 1] }}\n                      transition={{ repeat: Infinity, duration: 2 }}\n                    />\n                  )}\n                </div>\n                \n                {/* Text Content */}\n                <div className=\"flex flex-col items-start ml-4 flex-1 min-w-0\">\n                  <span className={cn(\n                    \"font-black text-sm tracking-tight uppercase italic transition-colors leading-none truncate w-full\",\n                    (isActive && !isMultiSelectMode) || (isSelected && isMultiSelectMode)\n                      ? \"text-foreground\" \n                      : \"text-muted-foreground opacity-60\"\n                  )}>\n                    {group.name}\n                  </span>\n                  \n                  {/* Status Indicator */}\n                  <div className=\"mt-2 h-3 flex items-center\">\n                    {isPlaying ? (\n                      <div className=\"flex gap-0.5 items-end h-full\">\n                        <motion.div \n                          animate={{ height: [3, 10, 5, 12, 3] }} \n                          transition={{ repeat: Infinity, duration: 1 }} \n                          className=\"w-0.5 bg-primary rounded-full\" \n                        />\n                        <motion.div \n                          animate={{ height: [6, 3, 10, 3, 8] }} \n                          transition={{ repeat: Infinity, duration: 0.8 }} \n                          className=\"w-0.5 bg-primary rounded-full\" \n                        />\n                        <motion.div \n                          animate={{ height: [8, 12, 3, 12, 6] }} \n                          transition={{ repeat: Infinity, duration: 1.2 }} \n                          className=\"w-0.5 bg-primary rounded-full\" \n                        />\n                      </div>\n                    ) : (\n                      <span className=\"text-[8px] font-black uppercase tracking-[0.2em] text-muted-foreground opacity-60 dark:opacity-40\">\n                        Standby\n                      </span>\n                    )}\n                  </div>\n                </div>\n              </motion.button>\n            );\n          })}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 566, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/components/dashboard/favorite-grid.tsx"],"sourcesContent":["\"use client\";\n\nimport { useSonos } from \"@/components/sonos-provider\";\nimport { Play, MoreVertical, Heart, ArrowRight, ChevronRight } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\n\nexport function FavoriteGrid() {\n  const { favorites, currentGroup, groups, refreshState, households, setCurrentPage } = useSonos();\n  const [browsingFavorite, setBrowsingFavorite] = useState<any | null>(null);\n  const [playlistTracks, setPlaylistTracks] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n\n  const playFavorite = async (favoriteId: string) => {\n    // Use currentGroup if available, otherwise use the first group\n    const activeGroup = currentGroup || (groups && groups.length > 0 ? groups[0] : null);\n    \n    if (!activeGroup) {\n      console.error(\"No active zone available to play favorite\");\n      return;\n    }\n\n    try {\n      const res = await fetch(`/api/sonos/control?groupId=${activeGroup.id}&favoriteId=${favoriteId}`, { \n        method: \"POST\" \n      });\n      \n      if (res.ok) {\n        await refreshState();\n      } else {\n        const errorData = await res.json();\n        console.error(\"Failed to play favorite:\", errorData);\n      }\n    } catch (error) {\n      console.error(\"Error playing favorite:\", error);\n    }\n  };\n\n  const browseFavorite = async (favorite: any) => {\n    if (!currentGroup || !households?.[0]) return;\n    \n    setLoading(true);\n    setBrowsingFavorite(favorite);\n\n    try {\n      // Get itemId from favorite\n      const itemId = favorite.itemId?.objectId || favorite.itemId;\n      const serviceId = favorite.itemId?.serviceId || favorite.serviceId;\n      const accountId = favorite.itemId?.accountId || favorite.accountId;\n\n      if (!itemId || !serviceId || !accountId) {\n        console.error(\"Missing favorite item information:\", favorite);\n        // Fallback: just play it\n        await playFavorite(favorite.id);\n        setBrowsingFavorite(null);\n        setLoading(false);\n        return;\n      }\n\n      // Try to get metadata to see if it's a container\n      const metadataRes = await fetch(`/api/sonos/library/metadata?accountId=${accountId}&itemId=${encodeURIComponent(itemId)}&serviceId=${serviceId}`);\n      \n      if (metadataRes.ok) {\n        const metadata = await metadataRes.json();\n        \n        // If it has containers or items, use those\n        if (metadata.containers || metadata.items) {\n          const normalizedItems = [\n            ...(metadata.containers || []).map((c: any) => ({\n              ...c,\n              id: c.id || { objectId: c.objectId, serviceId: c.serviceId || serviceId, accountId: c.accountId || accountId },\n            })),\n            ...(metadata.items || []).map((i: any) => ({\n              ...i,\n              id: i.id || { objectId: i.objectId, serviceId: i.serviceId || serviceId, accountId: i.accountId || accountId },\n            })),\n          ];\n          setPlaylistTracks(normalizedItems);\n          setLoading(false);\n          return;\n        }\n      }\n\n      // Fallback: try browsing the container\n      const browseRes = await fetch(`/api/sonos/library?accountId=${accountId}&containerId=${encodeURIComponent(itemId)}`);\n      \n      if (browseRes.ok) {\n        const data = await browseRes.json();\n        const normalizedItems = [\n          ...(data.containers || []).map((c: any) => ({\n            ...c,\n            id: c.id || { objectId: c.objectId, serviceId: c.serviceId || serviceId, accountId: c.accountId || accountId },\n          })),\n          ...(data.items || []).map((i: any) => ({\n            ...i,\n            id: i.id || { objectId: i.objectId, serviceId: i.serviceId || serviceId, accountId: i.accountId || accountId },\n          })),\n        ];\n        setPlaylistTracks(normalizedItems);\n      } else {\n        // If browsing fails, just play it\n        await playFavorite(favorite.id);\n        setBrowsingFavorite(null);\n      }\n    } catch (error) {\n      console.error(\"Failed to browse favorite:\", error);\n      // Fallback: just play it\n      await playFavorite(favorite.id);\n      setBrowsingFavorite(null);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const playTrack = async (item: any) => {\n    if (!currentGroup) return;\n    \n    const itemId = item.id?.objectId || item.objectId;\n    const serviceId = item.id?.serviceId || item.serviceId;\n    const accountId = item.id?.accountId || item.accountId;\n\n    if (!itemId || !serviceId || !accountId) {\n      console.error(\"Missing track information:\", item);\n      return;\n    }\n\n    try {\n      const res = await fetch(\"/api/sonos/library/action\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          groupId: currentGroup.id,\n          itemId,\n          serviceId,\n          accountId,\n          action: \"replace\",\n        }),\n      });\n\n      if (res.ok) {\n        await refreshState();\n      }\n    } catch (error) {\n      console.error(\"Failed to play track:\", error);\n    }\n  };\n\n  if (!favorites || favorites.length === 0) {\n    return (\n      <div className=\"flex flex-col items-center justify-center min-h-[60vh] text-center space-y-10 animate-in fade-in zoom-in duration-1000\">\n        <div className=\"relative h-48 w-48 flex items-center justify-center\">\n          <div className=\"absolute inset-0 bg-primary/5 blur-[60px] rounded-full animate-pulse\" />\n          <Play className=\"h-20 w-20 text-muted-foreground opacity-10\" />\n        </div>\n        <div className=\"space-y-3 max-w-sm\">\n          <h3 className=\"text-3xl font-black tracking-tight italic uppercase text-muted-foreground opacity-70 dark:opacity-60\">Your Gallery is Empty</h3>\n          <p className=\"text-muted-foreground font-bold text-sm tracking-tight leading-relaxed px-8 opacity-80 dark:opacity-70 uppercase\">\n            Curate your collection in the Sonos app to display your favorites here.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-20\">\n      <div className=\"flex items-end justify-between border-b border-foreground/10 dark:border-white/5 pb-10\">\n        <div className=\"space-y-2\">\n          <p className=\"text-[10px] font-black uppercase tracking-[0.6em] text-primary\">Discovery</p>\n          <h2 className=\"text-6xl lg:text-7xl font-black tracking-tighter italic uppercase leading-none\">Your Library</h2>\n        </div>\n        <button className=\"h-16 w-16 rounded-[2rem] bg-secondary/50 hover:bg-secondary flex items-center justify-center transition-all group border border-foreground/10 dark:border-white/5\">\n          <ArrowRight className=\"h-6 w-6 group-hover:translate-x-1 transition-transform\" />\n        </button>\n      </div>\n\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-x-12 gap-y-20\">\n        {favorites.map((favorite: any, index: number) => (\n          <motion.div\n            key={favorite.id}\n            initial={{ opacity: 0, y: 40 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: index * 0.05, duration: 1, ease: [0.22, 1, 0.36, 1] }}\n            onClick={(e) => {\n              e.stopPropagation();\n              // Check if it might be a playlist/container\n              const mightBeContainer = favorite.itemId || favorite.type?.includes(\"playlist\") || favorite.type?.includes(\"container\");\n              if (mightBeContainer) {\n                browseFavorite(favorite);\n              } else {\n                playFavorite(favorite.id);\n              }\n            }}\n            className=\"group cursor-pointer\"\n          >\n            {/* Massive Editorial Artwork */}\n            <div className=\"relative aspect-[4/5] rounded-[3.5rem] lg:rounded-[4.5rem] overflow-hidden bg-secondary shadow-[0_40px_100px_-20px_rgba(0,0,0,0.3)] group-hover:shadow-[0_60px_120px_-30px_rgba(0,0,0,0.5)] transition-all duration-700 ease-[0.22,1,0.36,1]\">\n              {favorite.imageUrl ? (\n                <img\n                  src={favorite.imageUrl}\n                  alt={favorite.name}\n                  className=\"object-cover w-full h-full transition-all duration-1000 group-hover:scale-110 grayscale-[30%] group-hover:grayscale-0 saturate-[0.8] group-hover:saturate-100\"\n                />\n              ) : (\n                <div className=\"w-full h-full bg-gradient-to-br from-secondary to-background flex items-center justify-center\">\n                  <span className=\"text-foreground/5 text-9xl font-black italic select-none\">ART</span>\n                </div>\n              )}\n              \n              {/* Cinematic Overlay */}\n              <div className=\"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent opacity-40 group-hover:opacity-60 transition-opacity duration-700\" />\n              \n              {/* Play Button - Always Visible */}\n              <button\n                onClick={(e) => {\n                  e.stopPropagation();\n                  playFavorite(favorite.id);\n                }}\n                className=\"absolute top-6 right-6 h-16 w-16 rounded-[2rem] bg-white dark:bg-foreground text-black dark:text-background flex items-center justify-center shadow-2xl hover:scale-110 transition-all duration-300 z-10\"\n                aria-label=\"Play favorite\"\n              >\n                <Play className=\"h-8 w-8 fill-current ml-1\" />\n              </button>\n              \n              <div className=\"absolute inset-0 flex flex-col justify-end p-10 opacity-0 group-hover:opacity-100 transition-all duration-500 translate-y-4 group-hover:translate-y-0\">\n                <div className={`h-20 w-20 rounded-[2rem] bg-white/20 dark:bg-foreground/20 backdrop-blur-lg text-white flex items-center justify-center shadow-2xl mb-6 ${(favorite.itemId || favorite.type?.includes(\"playlist\")) ? \"group-hover:scale-110 cursor-pointer\" : \"\"}`}\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    const mightBeContainer = favorite.itemId || favorite.type?.includes(\"playlist\") || favorite.type?.includes(\"container\");\n                    if (mightBeContainer) {\n                      browseFavorite(favorite);\n                    }\n                  }}\n                >\n                  {(favorite.itemId || favorite.type?.includes(\"playlist\")) ? (\n                    <ChevronRight className=\"h-8 w-8 fill-current\" />\n                  ) : (\n                    <Play className=\"h-8 w-8 fill-current ml-1\" />\n                  )}\n                </div>\n                <div className=\"space-y-1\">\n                  <span className=\"text-[10px] font-black uppercase tracking-[0.4em] text-white/80 dark:text-white/90\">\n                    {(favorite.itemId || favorite.type?.includes(\"playlist\")) ? \"Browse Playlist\" : \"Press to Play\"}\n                  </span>\n                  <p className=\"text-white dark:text-white text-xl font-black italic uppercase leading-tight truncate\">{favorite.name}</p>\n                </div>\n              </div>\n            </div>\n            \n            {/* Modern Typography Details */}\n            <div className=\"mt-10 px-6 space-y-3\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex flex-col min-w-0\">\n                  <h3 className=\"font-black text-2xl lg:text-3xl tracking-tighter leading-none truncate uppercase italic group-hover:text-primary transition-colors duration-500\">{favorite.name}</h3>\n                  <p className=\"text-sm font-bold text-muted-foreground uppercase tracking-widest mt-2 opacity-70 dark:opacity-60 truncate\">\n                    {favorite.description || \"Collection\"}\n                  </p>\n                </div>\n                <button className=\"h-10 w-10 flex items-center justify-center text-muted-foreground hover:text-foreground transition-colors shrink-0\">\n                  <MoreVertical className=\"h-5 w-5 text-muted-foreground opacity-50 dark:opacity-40\" />\n                </button>\n              </div>\n              \n              <div className=\"flex items-center gap-3 pt-2\">\n                <div className=\"h-px flex-1 bg-foreground/10 dark:bg-white/5 group-hover:bg-primary/30 dark:group-hover:bg-primary/20 transition-colors duration-700\" />\n                <span className=\"text-[10px] font-black uppercase tracking-[0.2em] text-muted-foreground opacity-60 dark:opacity-40\">Sonos Fav</span>\n              </div>\n            </div>\n          </motion.div>\n        ))}\n      </div>\n\n      {/* Playlist Tracks Modal/View */}\n      {browsingFavorite && (\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"fixed inset-0 z-50 bg-background/95 backdrop-blur-xl flex items-center justify-center p-8\"\n          onClick={() => {\n            setBrowsingFavorite(null);\n            setPlaylistTracks([]);\n          }}\n        >\n          <motion.div\n            initial={{ scale: 0.95, opacity: 0 }}\n            animate={{ scale: 1, opacity: 1 }}\n            onClick={(e) => e.stopPropagation()}\n            className=\"max-w-4xl w-full max-h-[80vh] overflow-y-auto no-scrollbar bg-foreground/[0.02] rounded-3xl border border-foreground/[0.05] p-8 space-y-6\"\n          >\n            <div className=\"flex items-center justify-between mb-6\">\n              <div>\n                <h2 className=\"text-4xl font-black uppercase italic tracking-tighter mb-2\">{browsingFavorite.name}</h2>\n                <p className=\"text-sm text-muted-foreground uppercase tracking-widest\">\n                  {playlistTracks.length} {playlistTracks.length === 1 ? \"Track\" : \"Tracks\"}\n                </p>\n              </div>\n              <Button\n                variant=\"ghost\"\n                onClick={() => {\n                  setBrowsingFavorite(null);\n                  setPlaylistTracks([]);\n                }}\n                className=\"h-12 w-12 rounded-full\"\n              >\n                <ArrowRight className=\"h-6 w-6 rotate-180\" />\n              </Button>\n            </div>\n\n            {loading ? (\n              <div className=\"flex items-center justify-center h-64\">\n                <Play className=\"h-8 w-8 animate-pulse text-primary\" />\n              </div>\n            ) : playlistTracks.length > 0 ? (\n              <div className=\"space-y-2\">\n                {playlistTracks.map((track, idx) => {\n                  const trackName = track.name || track.title || track.track?.name;\n                  const artistName = track.artist?.name || track.track?.artists?.map((a: any) => a.name).join(\", \");\n                  const imageUrl = track.imageUrl || track.images?.[0]?.url || track.track?.album?.images?.[0]?.url;\n                  const isContainer = track.type?.includes(\"container\") || track._objectType === \"container\";\n\n                  return (\n                    <motion.button\n                      key={track.id?.objectId || track.id || idx}\n                      initial={{ opacity: 0, x: -20 }}\n                      animate={{ opacity: 1, x: 0 }}\n                      transition={{ delay: idx * 0.05 }}\n                      onClick={() => {\n                        if (isContainer) {\n                          // Could browse deeper, but for now just play\n                          playTrack(track);\n                        } else {\n                          playTrack(track);\n                        }\n                      }}\n                      className=\"w-full flex items-center gap-4 p-4 rounded-2xl bg-foreground/[0.03] hover:bg-foreground/[0.06] border border-foreground/[0.05] hover:border-foreground/20 transition-all group text-left\"\n                    >\n                      <div className=\"h-16 w-16 rounded-xl overflow-hidden flex-shrink-0 bg-secondary\">\n                        {imageUrl ? (\n                          <img src={imageUrl} alt={trackName} className=\"w-full h-full object-cover\" />\n                        ) : (\n                          <div className=\"w-full h-full flex items-center justify-center\">\n                            <Play className=\"h-6 w-6 text-muted-foreground opacity-30\" />\n                          </div>\n                        )}\n                      </div>\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"font-black text-sm uppercase italic truncate\">{trackName}</p>\n                        {artistName && (\n                          <p className=\"text-xs text-muted-foreground uppercase tracking-widest mt-1 truncate opacity-70\">\n                            {artistName}\n                          </p>\n                        )}\n                      </div>\n                      <div className=\"opacity-0 group-hover:opacity-100 transition-opacity\">\n                        <Play className=\"h-5 w-5 text-primary\" />\n                      </div>\n                    </motion.button>\n                  );\n                })}\n              </div>\n            ) : (\n              <div className=\"flex flex-col items-center justify-center h-64\">\n                <Play className=\"h-16 w-16 text-muted-foreground opacity-20 mb-4\" />\n                <p className=\"text-muted-foreground uppercase tracking-widest\">No tracks found</p>\n                <p className=\"text-xs text-muted-foreground mt-2\">This playlist appears to be empty</p>\n              </div>\n            )}\n          </motion.div>\n        </motion.div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1336, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/components/dashboard/library-page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useSonos } from \"@/components/sonos-provider\";\nimport { Button } from \"@/components/ui/button\";\nimport { Play, Heart, Music, Disc, Users, ListMusic, Loader2, ChevronRight, ArrowLeft } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { motion } from \"framer-motion\";\nexport function LibraryPage() {\n  const { currentGroup, refreshState, favorites, households } = useSonos();\n  const [loading, setLoading] = useState(false);\n  const [browsingContainer, setBrowsingContainer] = useState<any | null>(null);\n  const [containerItems, setContainerItems] = useState<any[]>([]);\n  const [breadcrumb, setBreadcrumb] = useState<any[]>([]);\n\n\n  const handlePlay = async (item: any) => {\n    if (!currentGroup) return;\n\n    // Validate item\n    if (!item || Object.keys(item).length === 0) {\n      console.error(\"Cannot play empty item\");\n      return;\n    }\n\n    // If this is a favorite (has favoriteId), use loadFavorite\n    if (item.id && !browsingContainer && !item.itemId) {\n      // This is a favorite from the favorites list (not a browsed item)\n      try {\n        const res = await fetch(`/api/sonos/control?groupId=${currentGroup.id}&favoriteId=${item.id}`, {\n          method: \"POST\",\n        });\n        if (res.ok) {\n          await refreshState();\n          return;\n        }\n      } catch (error) {\n        console.error(\"Failed to load favorite:\", error);\n      }\n    }\n    \n    // Try multiple ways to extract item ID\n    const itemId = item.id?.objectId || item.objectId || item.track?.id?.objectId || item.track?.id;\n    \n    // Try to get serviceId and accountId from item, or fallback to browsing container\n    let serviceId = item.id?.serviceId || item.serviceId || item.track?.id?.serviceId || item.track?.serviceId;\n    let accountId = item.id?.accountId || item.accountId || item.track?.id?.accountId || item.track?.accountId;\n    \n    // If still missing and we're browsing a container, use the container's IDs\n    if ((!serviceId || !accountId) && browsingContainer) {\n      serviceId = serviceId || browsingContainer.id?.serviceId || browsingContainer.serviceId;\n      accountId = accountId || browsingContainer.id?.accountId || browsingContainer.accountId;\n    }\n\n    if (!itemId) {\n      console.error(\"Missing item ID:\", item);\n      return;\n    }\n\n    if (!serviceId || !accountId) {\n      console.error(\"Missing serviceId or accountId. Item:\", item, \"Browsing container:\", browsingContainer);\n      return;\n    }\n\n    try {\n      const res = await fetch(\"/api/sonos/library/action\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          groupId: currentGroup.id,\n          itemId,\n          serviceId,\n          accountId,\n          action: \"replace\",\n        }),\n      });\n\n      if (res.ok) {\n        await refreshState();\n      }\n    } catch (error) {\n      console.error(\"Failed to play item:\", error);\n    }\n  };\n\n  const handleAddToFavorites = async (item: any) => {\n    if (!currentGroup) return;\n    \n    const itemId = item.id?.objectId || item.objectId;\n    const serviceId = item.id?.serviceId || item.serviceId;\n    const accountId = item.id?.accountId || item.accountId;\n    const name = item.name || item.title;\n\n    if (!itemId || !serviceId || !accountId || !name) {\n      console.error(\"Missing item information:\", item);\n      return;\n    }\n\n    try {\n      const res = await fetch(\"/api/sonos/library/action\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          groupId: currentGroup.id,\n          itemId,\n          serviceId,\n          accountId,\n          name,\n          action: \"addToFavorites\",\n        }),\n      });\n\n      if (res.ok) {\n        await refreshState();\n      }\n    } catch (error) {\n      console.error(\"Failed to add to favorites:\", error);\n    }\n  };\n\n  const getItemIcon = (item: any) => {\n    const type = item.type || item._objectType || \"\";\n    if (type.includes(\"album\")) return Disc;\n    if (type.includes(\"artist\")) return Users;\n    if (type.includes(\"playlist\")) return ListMusic;\n    if (type.includes(\"container\")) return ListMusic;\n    return Music;\n  };\n\n  const handleBrowseContainer = async (item: any, addToBreadcrumb: boolean = true) => {\n    if (!currentGroup || !households?.[0]) return;\n    \n    // Validate item\n    if (!item || Object.keys(item).length === 0) {\n      console.error(\"Cannot browse empty item\");\n      return;\n    }\n    \n    // For favorites, try to get containerId from the item\n    let itemId = item.containerId || item.id?.objectId || item.objectId || item.track?.id?.objectId || item.track?.id;\n    let serviceId = item.id?.serviceId || item.serviceId || item.track?.id?.serviceId || item.track?.serviceId;\n    let accountId = item.id?.accountId || item.accountId || item.track?.id?.accountId || item.track?.accountId;\n\n    // If this is a favorite, try to get metadata from the favorite's itemId\n    if (item.id && !browsingContainer && item.itemId) {\n      // Favorite has an itemId that we can use\n      const favoriteItemId = item.itemId?.objectId || item.itemId;\n      const favoriteServiceId = item.itemId?.serviceId || item.serviceId;\n      const favoriteAccountId = item.itemId?.accountId || item.accountId;\n      \n      if (favoriteItemId && favoriteServiceId && favoriteAccountId) {\n        itemId = favoriteItemId;\n        serviceId = favoriteServiceId;\n        accountId = favoriteAccountId;\n      }\n    }\n\n    if (!itemId || !serviceId || !accountId) {\n      console.error(\"Missing item information for browsing:\", item);\n      // If it's missing info, try to play it directly (might be a track)\n      if (item.id) {\n        await handlePlay(item);\n      }\n      return;\n    }\n\n    setLoading(true);\n    setBrowsingContainer(item);\n    if (addToBreadcrumb) {\n      setBreadcrumb([...breadcrumb, item]);\n    }\n\n    try {\n      console.log(\"Browsing container with:\", { itemId, serviceId, accountId, item });\n      \n      // If this is a favorite (has item.id), try loading it first to get container info\n      if (item.id && !browsingContainer) {\n        console.log(\"This is a favorite, trying to load it first...\");\n        // Load the favorite to see what container it uses\n        const loadRes = await fetch(`/api/sonos/control?groupId=${currentGroup.id}&favoriteId=${item.id}`, {\n          method: \"POST\",\n        });\n        \n        if (loadRes.ok) {\n          // Wait a moment for playback to start\n          await new Promise(resolve => setTimeout(resolve, 1000));\n          \n          // Get playback metadata to see the container\n          const pbRes = await fetch(`/api/sonos/playback?groupId=${currentGroup.id}`);\n          if (pbRes.ok) {\n            const pbData = await pbRes.json();\n            console.log(\"Playback data after loading favorite:\", pbData);\n            \n            // Check if we can get container info from playback\n            if (pbData.container?.id) {\n              const containerId = pbData.container.id.objectId || pbData.container.id;\n              const containerServiceId = pbData.container.id.serviceId || pbData.container.service?.id;\n              const containerAccountId = pbData.container.id.accountId || accountId;\n              \n              console.log(\"Found container from playback:\", { containerId, containerServiceId, containerAccountId });\n              \n              // Try to browse this container\n              const browseRes = await fetch(`/api/sonos/library?accountId=${containerAccountId}&containerId=${encodeURIComponent(containerId)}`);\n              if (browseRes.ok) {\n                const data = await browseRes.json();\n                console.log(\"Browse result:\", data);\n                const normalizedItems = [\n                  ...(data.containers || []).map((c: any) => ({\n                    ...c,\n                    id: c.id || { objectId: c.objectId, serviceId: c.serviceId || containerServiceId, accountId: c.accountId || containerAccountId },\n                  })),\n                  ...(data.items || []).map((i: any) => ({\n                    ...i,\n                    id: i.id || { objectId: i.objectId, serviceId: i.serviceId || containerServiceId, accountId: i.accountId || containerAccountId },\n                  })),\n                ];\n                setContainerItems(normalizedItems);\n                setLoading(false);\n                await refreshState();\n                return;\n              }\n            }\n          }\n        }\n      }\n      \n      // Try to get metadata first to see if it's a container\n      console.log(\"Trying metadata endpoint...\");\n      const metadataRes = await fetch(`/api/sonos/library/metadata?accountId=${accountId}&itemId=${encodeURIComponent(itemId)}&serviceId=${serviceId}`);\n      \n      if (metadataRes.ok) {\n        const metadata = await metadataRes.json();\n        console.log(\"Metadata result:\", metadata);\n        \n        // If it has containers or items, use those\n        if (metadata.containers || metadata.items) {\n          // Normalize items to ensure they have proper structure\n          const normalizedItems = [\n            ...(metadata.containers || []).map((c: any) => ({\n              ...c,\n              id: c.id || { objectId: c.objectId, serviceId: c.serviceId || serviceId, accountId: c.accountId || accountId },\n            })),\n            ...(metadata.items || []).map((i: any) => ({\n              ...i,\n              id: i.id || { objectId: i.objectId, serviceId: i.serviceId || serviceId, accountId: i.accountId || accountId },\n            })),\n          ];\n          console.log(\"Setting container items from metadata:\", normalizedItems);\n          setContainerItems(normalizedItems);\n          setLoading(false);\n          return;\n        }\n      } else {\n        const errorData = await metadataRes.json().catch(() => ({}));\n        console.error(\"Metadata request failed:\", errorData);\n      }\n\n      // Fallback: try browsing the container using the itemId\n      console.log(\"Trying browse endpoint...\");\n      const browseRes = await fetch(`/api/sonos/library?accountId=${accountId}&containerId=${encodeURIComponent(itemId)}`);\n      \n      if (browseRes.ok) {\n        const data = await browseRes.json();\n        console.log(\"Browse result:\", data);\n        // Normalize items to ensure they have proper structure\n        const normalizedItems = [\n          ...(data.containers || []).map((c: any) => ({\n            ...c,\n            id: c.id || { objectId: c.objectId, serviceId: c.serviceId || serviceId, accountId: c.accountId || accountId },\n          })),\n          ...(data.items || []).map((i: any) => ({\n            ...i,\n            id: i.id || { objectId: i.objectId, serviceId: i.serviceId || serviceId, accountId: i.accountId || accountId },\n          })),\n        ];\n        console.log(\"Setting container items from browse:\", normalizedItems);\n        setContainerItems(normalizedItems);\n      } else {\n        const errorData = await browseRes.json().catch(() => ({}));\n        console.error(\"Browse failed:\", errorData);\n        // If browsing fails, try to play it directly (might be a track)\n        await handlePlay(item);\n        setBrowsingContainer(null);\n        setBreadcrumb([]);\n      }\n    } catch (error) {\n      console.error(\"Failed to browse container:\", error);\n      // Fallback: try to play it directly\n      await handlePlay(item);\n      setBrowsingContainer(null);\n      setBreadcrumb([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleBack = () => {\n    if (breadcrumb.length > 1) {\n      const newBreadcrumb = breadcrumb.slice(0, -1);\n      const previousItem = newBreadcrumb[newBreadcrumb.length - 1];\n      setBreadcrumb(newBreadcrumb);\n      handleBrowseContainer(previousItem, false);\n    } else {\n      setBrowsingContainer(null);\n      setContainerItems([]);\n      setBreadcrumb([]);\n    }\n  };\n\n\n  const renderItem = (item: any, idx: number, onClick?: () => void) => {\n    // Skip empty items\n    if (!item || Object.keys(item).length === 0) {\n      return null;\n    }\n\n    const Icon = getItemIcon(item);\n    const imageUrl = item.imageUrl || item.images?.[0]?.url || item.track?.album?.images?.[0]?.url;\n    const itemName = item.name || item.title || item.track?.name;\n    \n    // Better container detection - check multiple indicators\n    // For favorites, assume they might be containers if they have an itemId\n    const isContainer = \n      item.type?.includes(\"container\") || \n      item._objectType === \"container\" || \n      item.type?.includes(\"playlist\") || \n      item.type?.includes(\"album\") ||\n      item.containerId !== undefined ||\n      (item.itemId && (item.itemId.type === \"container\" || item.itemId._objectType === \"container\")) ||\n      // If it's a favorite (has id but not browsing), always try to browse it first\n      (item.id && item.itemId && !browsingContainer) ||\n      // If name suggests it's a playlist/album\n      (itemName && (itemName.toLowerCase().includes(\"playlist\") || itemName.toLowerCase().includes(\"album\"))) ||\n      // If description suggests multiple tracks\n      (item.description && item.description.toLowerCase().includes(\"track\"));\n\n    return (\n      <motion.div\n        key={item.id?.objectId || item.id || idx}\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ delay: idx * 0.05 }}\n        className=\"group relative\"\n      >\n        <div \n          className=\"aspect-square rounded-2xl overflow-hidden bg-foreground/[0.03] border border-foreground/[0.05] hover:border-foreground/20 transition-all cursor-pointer\"\n          onClick={onClick || ((e) => {\n            e.stopPropagation();\n            // Validate item has required information\n            if (!item || Object.keys(item).length === 0) {\n              console.error(\"Cannot interact with empty item\");\n              return;\n            }\n            \n            console.log(\"Item clicked:\", item, \"isContainer:\", isContainer);\n            \n            // For favorites in library, always try to browse first if they have itemId\n            // This allows exploring playlists\n            if (isContainer || (!browsingContainer && item.id && item.itemId)) {\n              console.log(\"Attempting to browse container:\", item);\n              handleBrowseContainer(item);\n            } else if (!browsingContainer && item.id) {\n              // If it's a favorite without itemId, try to play it\n              console.log(\"Playing favorite:\", item);\n              handlePlay(item);\n            } else {\n              // For browsed items, play them\n              console.log(\"Playing item:\", item);\n              handlePlay(item);\n            }\n          })}\n        >\n          {imageUrl ? (\n            <img src={imageUrl} alt={itemName} className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500\" />\n          ) : (\n            <div className=\"w-full h-full flex items-center justify-center\">\n              <Icon className=\"h-12 w-12 text-muted-foreground\" />\n            </div>\n          )}\n          \n          {/* Overlay Actions */}\n          <div className=\"absolute inset-0 bg-black/60 dark:bg-black/80 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-4\">\n            {isContainer ? (\n              <Button\n                variant=\"default\"\n                size=\"icon\"\n                className=\"h-14 w-14 rounded-full bg-foreground text-background\"\n                onClick={(e) => {\n                  e.stopPropagation();\n                  console.log(\"Browse button clicked for:\", item);\n                  handleBrowseContainer(item);\n                }}\n              >\n                <ChevronRight className=\"h-6 w-6\" />\n              </Button>\n            ) : (\n              <>\n                <Button\n                  variant=\"default\"\n                  size=\"icon\"\n                  className=\"h-14 w-14 rounded-full bg-foreground text-background\"\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    console.log(\"Play button clicked for:\", item);\n                    handlePlay(item);\n                  }}\n                >\n                  <Play className=\"h-6 w-6 fill-current ml-0.5\" />\n                </Button>\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className=\"h-12 w-12 rounded-full bg-white/20 dark:bg-white/10 text-white hover:bg-white/30 dark:hover:bg-white/20\"\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    handleAddToFavorites(item);\n                  }}\n                >\n                  <Heart className=\"h-5 w-5\" />\n                </Button>\n              </>\n            )}\n          </div>\n        </div>\n        \n        <div className=\"mt-3\">\n          <p className=\"font-black text-xs uppercase italic truncate\">{itemName}</p>\n          {(item.artist?.name || item.track?.artists?.[0]?.name) && (\n            <p className=\"text-[10px] text-muted-foreground uppercase tracking-widest mt-1 truncate\">\n              {item.artist?.name || item.track?.artists?.map((a: any) => a.name).join(\", \")}\n            </p>\n          )}\n          {isContainer && (\n            <p className=\"text-[10px] text-muted-foreground uppercase tracking-widest mt-1 opacity-60\">\n              {item.type || item._objectType || \"Container\"}\n            </p>\n          )}\n        </div>\n      </motion.div>\n    );\n  };\n\n  // Filter out empty or invalid items\n  const validFavorites = favorites.filter((item: any) => \n    item && Object.keys(item).length > 0 && (item.name || item.title || item.id)\n  );\n  const validContainerItems = containerItems.filter((item: any) => \n    item && Object.keys(item).length > 0 && (item.name || item.title || item.id)\n  );\n  const itemsToDisplay = browsingContainer ? validContainerItems : validFavorites;\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-3xl font-black uppercase italic tracking-tighter mb-2\">\n            {browsingContainer ? browsingContainer.name : \"Your Library\"}\n          </h2>\n          <p className=\"text-sm text-muted-foreground uppercase tracking-widest\">\n            {browsingContainer ? \"Contents\" : \"Sonos Favorites\"}\n          </p>\n        </div>\n        \n        {browsingContainer && (\n          <Button\n            variant=\"ghost\"\n            onClick={handleBack}\n            className=\"flex items-center gap-2\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            <span className=\"text-xs font-black uppercase tracking-widest\">Back</span>\n          </Button>\n        )}\n      </div>\n\n      {/* Breadcrumb */}\n      {breadcrumb.length > 0 && (\n        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n          <button \n            onClick={() => {\n              setBrowsingContainer(null);\n              setContainerItems([]);\n              setBreadcrumb([]);\n            }} \n            className=\"hover:text-foreground transition-colors\"\n          >\n            Library\n          </button>\n          {breadcrumb.map((item, idx) => (\n            <div key={idx} className=\"flex items-center gap-2\">\n              <ChevronRight className=\"h-4 w-4\" />\n              <button\n                onClick={() => {\n                  const newBreadcrumb = breadcrumb.slice(0, idx + 1);\n                  setBreadcrumb(newBreadcrumb);\n                  if (idx < breadcrumb.length - 1) {\n                    handleBrowseContainer(item, false);\n                  }\n                }}\n                className=\"hover:text-foreground transition-colors truncate max-w-[200px]\"\n              >\n                {item.name}\n              </button>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {loading ? (\n        <div className=\"flex items-center justify-center h-64\">\n          <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n        </div>\n      ) : itemsToDisplay.length > 0 ? (\n        <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4\">\n          {itemsToDisplay\n            .filter((item) => item && Object.keys(item).length > 0 && (item.name || item.title || item.id))\n            .map((item, idx) => renderItem(item, idx))\n            .filter(Boolean)}\n        </div>\n      ) : browsingContainer ? (\n        <div className=\"flex flex-col items-center justify-center h-64 bg-foreground/[0.02] rounded-3xl border border-foreground/[0.05]\">\n          <Music className=\"h-16 w-16 text-muted-foreground opacity-30 dark:opacity-20 mb-4\" />\n          <p className=\"text-muted-foreground uppercase tracking-widest mb-2 text-center\">No Items Found</p>\n          <p className=\"text-xs text-muted-foreground text-center max-w-md px-4\">\n            This container appears to be empty or cannot be browsed.\n          </p>\n        </div>\n      ) : (\n        <div className=\"flex flex-col items-center justify-center h-64 bg-foreground/[0.02] rounded-3xl border border-foreground/[0.05]\">\n          <Music className=\"h-16 w-16 text-muted-foreground opacity-30 dark:opacity-20 mb-4\" />\n          <p className=\"text-muted-foreground uppercase tracking-widest mb-2 text-center\">No Favorites Yet</p>\n          <p className=\"text-xs text-muted-foreground text-center max-w-md px-4 mb-4\">\n            Add favorites in the Sonos app to see them here.\n          </p>\n          <div className=\"bg-foreground/[0.03] rounded-2xl p-4 border border-foreground/[0.05] max-w-md\">\n            <p className=\"text-[10px] font-black uppercase tracking-[0.2em] text-primary mb-2\">How to Add Favorites</p>\n            <ol className=\"text-xs text-muted-foreground space-y-1 list-decimal list-inside text-left\">\n              <li>Open the Sonos app</li>\n              <li>Browse and play music</li>\n              <li>Add items to favorites (heart icon)</li>\n              <li>Return here to see your favorites</li>\n            </ol>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2122, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/components/dashboard/settings-page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useSonos } from \"@/components/sonos-provider\";\nimport { useDevice } from \"@/components/device-provider\";\nimport { Button } from \"@/components/ui/button\";\nimport { Settings, Radio, Check, X, LogOut, RefreshCw, Loader2, Monitor, MonitorSmartphone, Tv, Laptop, RotateCcw, AlertTriangle } from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { cn } from \"@/lib/utils\";\n\nexport function SettingsPage() {\n  const { refreshState } = useSonos();\n  const { deviceType, deviceConfig } = useDevice();\n  const [sonosConnected, setSonosConnected] = useState<boolean>(false);\n  const [loading, setLoading] = useState(false);\n  const [checking, setChecking] = useState(true);\n  const [resetting, setResetting] = useState(false);\n  const [showResetConfirm, setShowResetConfirm] = useState(false);\n\n  useEffect(() => {\n    checkConnections();\n  }, []);\n\n  const checkConnections = async () => {\n    setChecking(true);\n    \n    // Check Sonos connection\n    try {\n      const res = await fetch(\"/api/sonos/state\");\n      setSonosConnected(res.ok);\n    } catch (error) {\n      setSonosConnected(false);\n    }\n    \n    setChecking(false);\n  };\n\n  const reconnectSonos = async () => {\n    window.location.href = \"/api/sonos/login\";\n  };\n\n  const disconnectSonos = async () => {\n    setLoading(true);\n    try {\n      const res = await fetch(\"/api/sonos/disconnect\", { method: \"POST\" });\n      if (res.ok) {\n        setSonosConnected(false);\n        await checkConnections();\n        // Redirect to setup if disconnected\n        window.location.href = \"/setup\";\n      }\n    } catch (error) {\n      console.error(\"Failed to disconnect Sonos:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const resetDevice = async () => {\n    setResetting(true);\n    try {\n      const res = await fetch(\"/api/reset-device\", { method: \"POST\" });\n      if (res.ok) {\n        // Redirect to setup page for fresh setup\n        window.location.href = \"/setup\";\n      } else {\n        const errorData = await res.json();\n        console.error(\"Failed to reset device:\", errorData);\n        alert(\"Failed to reset device. Please try again.\");\n        setResetting(false);\n        setShowResetConfirm(false);\n      }\n    } catch (error) {\n      console.error(\"Failed to reset device:\", error);\n      alert(\"Failed to reset device. Please try again.\");\n      setResetting(false);\n      setShowResetConfirm(false);\n    }\n  };\n\n  if (checking) {\n    return (\n      <div className=\"flex items-center justify-center h-full\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-8 max-w-4xl\">\n      <div>\n        <h1 className=\"text-4xl font-black uppercase italic tracking-tighter mb-2\">Settings</h1>\n        <p className=\"text-sm text-muted-foreground uppercase tracking-widest\">Manage your connections</p>\n      </div>\n\n      {/* Device Information */}\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        className=\"rounded-3xl bg-foreground/[0.02] border border-foreground/[0.05] p-8 space-y-6\"\n      >\n        <div className=\"flex items-center gap-4\">\n          <div className=\"h-16 w-16 rounded-2xl bg-foreground/[0.05] flex items-center justify-center relative overflow-hidden\">\n            {deviceType === \"theWall\" ? (\n              <div className=\"flex flex-col items-center justify-center\">\n                {/* Wall-mounted screen representation */}\n                <div className=\"relative\">\n                  <Tv className=\"h-8 w-8 text-foreground\" />\n                  {/* Wall mount brackets */}\n                  <div className=\"absolute -top-1 left-0 right-0 flex justify-between px-1\">\n                    <div className=\"h-1 w-1 rounded-full bg-foreground/40\" />\n                    <div className=\"h-1 w-1 rounded-full bg-foreground/40\" />\n                  </div>\n                </div>\n              </div>\n            ) : deviceType === \"theDesk\" ? (\n              <div className=\"flex flex-col items-center justify-center\">\n                {/* Desk-mounted device representation */}\n                <Monitor className=\"h-6 w-6 text-foreground mb-0.5\" />\n                {/* Stand/base */}\n                <div className=\"flex items-center gap-0.5 mt-0.5\">\n                  <div className=\"h-1 w-3 bg-foreground/30 rounded-sm\" />\n                  <div className=\"h-1 w-2 bg-foreground/40 rounded-sm\" />\n                  <div className=\"h-1 w-3 bg-foreground/30 rounded-sm\" />\n                </div>\n              </div>\n            ) : (\n              <Settings className=\"h-6 w-6 text-foreground\" />\n            )}\n          </div>\n          <div>\n            <h2 className=\"text-xl font-black uppercase italic tracking-tighter\">Device</h2>\n            <p className=\"text-xs text-muted-foreground uppercase tracking-widest mt-1\">\n              Your device configuration\n            </p>\n          </div>\n        </div>\n\n        {deviceConfig ? (\n          <div className=\"pt-4 border-t border-foreground/[0.05] space-y-4\">\n            <div className=\"flex items-center justify-between text-sm\">\n              <span className=\"text-muted-foreground uppercase tracking-widest\">Device Name</span>\n              <span className=\"font-black text-foreground\">{deviceConfig.name}</span>\n            </div>\n            <div className=\"flex items-center justify-between text-sm\">\n              <span className=\"text-muted-foreground uppercase tracking-widest\">Screen Size</span>\n              <span className=\"font-black text-foreground\">{deviceConfig.screenSize}</span>\n            </div>\n          </div>\n        ) : (\n          <div className=\"pt-4 border-t border-foreground/[0.05]\">\n            <p className=\"text-xs text-muted-foreground\">\n              No device configured. Please select a device during setup.\n            </p>\n          </div>\n        )}\n      </motion.div>\n\n      {/* Sonos Connection */}\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        className=\"rounded-3xl bg-foreground/[0.02] border border-foreground/[0.05] p-8 space-y-6\"\n      >\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"h-12 w-12 rounded-2xl bg-foreground/[0.05] flex items-center justify-center\">\n              <Radio className=\"h-6 w-6 text-foreground\" />\n            </div>\n            <div>\n              <h2 className=\"text-xl font-black uppercase italic tracking-tighter\">Sonos Account</h2>\n              <p className=\"text-xs text-muted-foreground uppercase tracking-widest mt-1\">\n                Control your Sonos speakers\n              </p>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-3\">\n            {sonosConnected ? (\n              <>\n                <div className=\"flex items-center gap-2 px-4 py-2 rounded-full bg-primary/10 border border-primary/20\">\n                  <Check className=\"h-4 w-4 text-primary\" />\n                  <span className=\"text-xs font-black uppercase tracking-widest text-primary\">Connected</span>\n                </div>\n                <Button\n                  variant=\"ghost\"\n                  onClick={disconnectSonos}\n                  disabled={loading}\n                  className=\"px-6 py-2 rounded-2xl\"\n                >\n                  <LogOut className=\"h-4 w-4 mr-2\" />\n                  Disconnect\n                </Button>\n              </>\n            ) : (\n              <Button\n                onClick={reconnectSonos}\n                className=\"px-6 py-2 rounded-2xl bg-foreground text-background font-black uppercase tracking-widest\"\n              >\n                Connect Sonos\n              </Button>\n            )}\n          </div>\n        </div>\n\n        {sonosConnected && (\n          <div className=\"pt-4 border-t border-foreground/[0.05]\">\n            <div className=\"flex items-center justify-between text-sm\">\n              <span className=\"text-muted-foreground uppercase tracking-widest\">Status</span>\n              <span className=\"font-black text-foreground\">Active</span>\n            </div>\n            <div className=\"flex items-center justify-between text-sm mt-2\">\n              <span className=\"text-muted-foreground uppercase tracking-widest\">Last Sync</span>\n              <span className=\"font-black text-foreground\">Just now</span>\n            </div>\n          </div>\n        )}\n      </motion.div>\n\n      {/* Reset Device Section */}\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        className=\"rounded-3xl bg-red-500/5 border border-red-500/20 p-8 space-y-6\"\n      >\n        <div className=\"flex items-center gap-4\">\n          <div className=\"h-12 w-12 rounded-2xl bg-red-500/10 flex items-center justify-center\">\n            <RotateCcw className=\"h-6 w-6 text-red-500\" />\n          </div>\n          <div>\n            <h2 className=\"text-xl font-black uppercase italic tracking-tighter text-red-500\">Reset Device</h2>\n            <p className=\"text-xs text-muted-foreground uppercase tracking-widest mt-1\">\n              Factory reset - removes all configuration\n            </p>\n          </div>\n        </div>\n\n        <div className=\"pt-4 border-t border-red-500/20\">\n          <p className=\"text-sm text-muted-foreground mb-4\">\n            This will remove your device configuration and Sonos account. You will need to set up the device again from scratch.\n          </p>\n          \n          {!showResetConfirm ? (\n            <Button\n              variant=\"ghost\"\n              onClick={() => setShowResetConfirm(true)}\n              className=\"px-6 py-2 rounded-2xl border border-red-500/30 text-red-500 hover:bg-red-500/10 hover:border-red-500/50 transition-all\"\n            >\n              <RotateCcw className=\"h-4 w-4 mr-2\" />\n              Reset Device\n            </Button>\n          ) : (\n            <div className=\"space-y-4\">\n              <div className=\"flex items-start gap-3 p-4 rounded-2xl bg-red-500/10 border border-red-500/20\">\n                <AlertTriangle className=\"h-5 w-5 text-red-500 mt-0.5 shrink-0\" />\n                <div className=\"flex-1\">\n                  <p className=\"text-sm font-bold text-red-500 mb-1\">Are you sure?</p>\n                  <p className=\"text-xs text-muted-foreground\">\n                    This action cannot be undone. All device settings and Sonos account will be permanently removed.\n                  </p>\n                </div>\n              </div>\n              <div className=\"flex gap-3\">\n                <Button\n                  variant=\"ghost\"\n                  onClick={() => setShowResetConfirm(false)}\n                  disabled={resetting}\n                  className=\"px-6 py-2 rounded-2xl\"\n                >\n                  Cancel\n                </Button>\n                <Button\n                  onClick={resetDevice}\n                  disabled={resetting}\n                  className=\"px-6 py-2 rounded-2xl bg-red-500 text-white hover:bg-red-600 font-black uppercase tracking-widest\"\n                >\n                  {resetting ? (\n                    <>\n                      <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\n                      Resetting...\n                    </>\n                  ) : (\n                    <>\n                      <RotateCcw className=\"h-4 w-4 mr-2\" />\n                      Confirm Reset\n                    </>\n                  )}\n                </Button>\n              </div>\n            </div>\n          )}\n        </div>\n      </motion.div>\n\n      {/* Refresh Button */}\n      <div className=\"flex justify-end\">\n        <Button\n          variant=\"ghost\"\n          onClick={checkConnections}\n          className=\"px-6 py-2 rounded-2xl\"\n        >\n          <RefreshCw className=\"h-4 w-4 mr-2\" />\n          Refresh Status\n        </Button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAPA;;;;;;;;AAUO,SAAS;IACd,MAAM,EAAE,YAAY,EAAE,GAAG,IAAA,mJAAQ;IACjC,MAAM,EAAE,UAAU,EAAE,YAAY,EAAE,GAAG,IAAA,qJAAS;IAC9C,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAAU;IAC9D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IACzC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,iNAAQ,EAAC;IAEzD,IAAA,kNAAS,EAAC;QACR;IACF,GAAG,EAAE;IAEL,MAAM,mBAAmB;QACvB,YAAY;QAEZ,yBAAyB;QACzB,IAAI;YACF,MAAM,MAAM,MAAM,MAAM;YACxB,kBAAkB,IAAI,EAAE;QAC1B,EAAE,OAAO,OAAO;YACd,kBAAkB;QACpB;QAEA,YAAY;IACd;IAEA,MAAM,iBAAiB;QACrB,OAAO,QAAQ,CAAC,IAAI,GAAG;IACzB;IAEA,MAAM,kBAAkB;QACtB,WAAW;QACX,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,yBAAyB;gBAAE,QAAQ;YAAO;YAClE,IAAI,IAAI,EAAE,EAAE;gBACV,kBAAkB;gBAClB,MAAM;gBACN,oCAAoC;gBACpC,OAAO,QAAQ,CAAC,IAAI,GAAG;YACzB;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,+BAA+B;QAC/C,SAAU;YACR,WAAW;QACb;IACF;IAEA,MAAM,cAAc;QAClB,aAAa;QACb,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,qBAAqB;gBAAE,QAAQ;YAAO;YAC9D,IAAI,IAAI,EAAE,EAAE;gBACV,yCAAyC;gBACzC,OAAO,QAAQ,CAAC,IAAI,GAAG;YACzB,OAAO;gBACL,MAAM,YAAY,MAAM,IAAI,IAAI;gBAChC,QAAQ,KAAK,CAAC,2BAA2B;gBACzC,MAAM;gBACN,aAAa;gBACb,oBAAoB;YACtB;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;YACzC,MAAM;YACN,aAAa;YACb,oBAAoB;QACtB;IACF;IAEA,IAAI,UAAU;QACZ,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC,4NAAO;gBAAC,WAAU;;;;;;;;;;;IAGzB;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;;kCACC,8OAAC;wBAAG,WAAU;kCAA6D;;;;;;kCAC3E,8OAAC;wBAAE,WAAU;kCAA0D;;;;;;;;;;;;0BAIzE,8OAAC,oMAAM,CAAC,GAAG;gBACT,SAAS;oBAAE,SAAS;oBAAG,GAAG;gBAAG;gBAC7B,SAAS;oBAAE,SAAS;oBAAG,GAAG;gBAAE;gBAC5B,WAAU;;kCAEV,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;0CACZ,eAAe,0BACd,8OAAC;oCAAI,WAAU;8CAEb,cAAA,8OAAC;wCAAI,WAAU;;0DACb,8OAAC,oMAAE;gDAAC,WAAU;;;;;;0DAEd,8OAAC;gDAAI,WAAU;;kEACb,8OAAC;wDAAI,WAAU;;;;;;kEACf,8OAAC;wDAAI,WAAU;;;;;;;;;;;;;;;;;;;;;;2CAInB,eAAe,0BACjB,8OAAC;oCAAI,WAAU;;sDAEb,8OAAC,mNAAO;4CAAC,WAAU;;;;;;sDAEnB,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDAAI,WAAU;;;;;;8DACf,8OAAC;oDAAI,WAAU;;;;;;8DACf,8OAAC;oDAAI,WAAU;;;;;;;;;;;;;;;;;yDAInB,8OAAC,sNAAQ;oCAAC,WAAU;;;;;;;;;;;0CAGxB,8OAAC;;kDACC,8OAAC;wCAAG,WAAU;kDAAuD;;;;;;kDACrE,8OAAC;wCAAE,WAAU;kDAA+D;;;;;;;;;;;;;;;;;;oBAM/E,6BACC,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAK,WAAU;kDAAkD;;;;;;kDAClE,8OAAC;wCAAK,WAAU;kDAA8B,aAAa,IAAI;;;;;;;;;;;;0CAEjE,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAK,WAAU;kDAAkD;;;;;;kDAClE,8OAAC;wCAAK,WAAU;kDAA8B,aAAa,UAAU;;;;;;;;;;;;;;;;;6CAIzE,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BAAE,WAAU;sCAAgC;;;;;;;;;;;;;;;;;0BAQnD,8OAAC,oMAAM,CAAC,GAAG;gBACT,SAAS;oBAAE,SAAS;oBAAG,GAAG;gBAAG;gBAC7B,SAAS;oBAAE,SAAS;oBAAG,GAAG;gBAAE;gBAC5B,WAAU;;kCAEV,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAI,WAAU;kDACb,cAAA,8OAAC,6MAAK;4CAAC,WAAU;;;;;;;;;;;kDAEnB,8OAAC;;0DACC,8OAAC;gDAAG,WAAU;0DAAuD;;;;;;0DACrE,8OAAC;gDAAE,WAAU;0DAA+D;;;;;;;;;;;;;;;;;;0CAKhF,8OAAC;gCAAI,WAAU;0CACZ,+BACC;;sDACE,8OAAC;4CAAI,WAAU;;8DACb,8OAAC,6MAAK;oDAAC,WAAU;;;;;;8DACjB,8OAAC;oDAAK,WAAU;8DAA4D;;;;;;;;;;;;sDAE9E,8OAAC,4IAAM;4CACL,SAAQ;4CACR,SAAS;4CACT,UAAU;4CACV,WAAU;;8DAEV,8OAAC,oNAAM;oDAAC,WAAU;;;;;;gDAAiB;;;;;;;;iEAKvC,8OAAC,4IAAM;oCACL,SAAS;oCACT,WAAU;8CACX;;;;;;;;;;;;;;;;;oBAON,gCACC,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAK,WAAU;kDAAkD;;;;;;kDAClE,8OAAC;wCAAK,WAAU;kDAA6B;;;;;;;;;;;;0CAE/C,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAK,WAAU;kDAAkD;;;;;;kDAClE,8OAAC;wCAAK,WAAU;kDAA6B;;;;;;;;;;;;;;;;;;;;;;;;0BAOrD,8OAAC,oMAAM,CAAC,GAAG;gBACT,SAAS;oBAAE,SAAS;oBAAG,GAAG;gBAAG;gBAC7B,SAAS;oBAAE,SAAS;oBAAG,GAAG;gBAAE;gBAC5B,WAAU;;kCAEV,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC,6NAAS;oCAAC,WAAU;;;;;;;;;;;0CAEvB,8OAAC;;kDACC,8OAAC;wCAAG,WAAU;kDAAoE;;;;;;kDAClF,8OAAC;wCAAE,WAAU;kDAA+D;;;;;;;;;;;;;;;;;;kCAMhF,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAE,WAAU;0CAAqC;;;;;;4BAIjD,CAAC,iCACA,8OAAC,4IAAM;gCACL,SAAQ;gCACR,SAAS,IAAM,oBAAoB;gCACnC,WAAU;;kDAEV,8OAAC,6NAAS;wCAAC,WAAU;;;;;;oCAAiB;;;;;;qDAIxC,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAI,WAAU;;0DACb,8OAAC,yOAAa;gDAAC,WAAU;;;;;;0DACzB,8OAAC;gDAAI,WAAU;;kEACb,8OAAC;wDAAE,WAAU;kEAAsC;;;;;;kEACnD,8OAAC;wDAAE,WAAU;kEAAgC;;;;;;;;;;;;;;;;;;kDAKjD,8OAAC;wCAAI,WAAU;;0DACb,8OAAC,4IAAM;gDACL,SAAQ;gDACR,SAAS,IAAM,oBAAoB;gDACnC,UAAU;gDACV,WAAU;0DACX;;;;;;0DAGD,8OAAC,4IAAM;gDACL,SAAS;gDACT,UAAU;gDACV,WAAU;0DAET,0BACC;;sEACE,8OAAC,4NAAO;4DAAC,WAAU;;;;;;wDAA8B;;iFAInD;;sEACE,8OAAC,6NAAS;4DAAC,WAAU;;;;;;wDAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAYtD,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC,4IAAM;oBACL,SAAQ;oBACR,SAAS;oBACT,WAAU;;sCAEV,8OAAC,6NAAS;4BAAC,WAAU;;;;;;wBAAiB;;;;;;;;;;;;;;;;;;AAMhD"}},
    {"offset": {"line": 2919, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/components/ui/slider.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,uBAAS,mNAAgB,CAG7B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,0KAAoB;QACnB,KAAK;QACL,WAAW,IAAA,yHAAE,EACX,4DACA;QAED,GAAG,KAAK;;0BAET,8OAAC,2KAAqB;gBAAC,WAAU;0BAC/B,cAAA,8OAAC,2KAAqB;oBAAC,WAAU;;;;;;;;;;;0BAEnC,8OAAC,2KAAqB;gBAAC,WAAU;;;;;;;;;;;;AAGrC,OAAO,WAAW,GAAG,0KAAoB,CAAC,WAAW"}},
    {"offset": {"line": 2970, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/components/player/zone-selector.tsx"],"sourcesContent":["\"use client\";\n\nimport { useSonos } from \"@/components/sonos-provider\";\nimport { Button } from \"@/components/ui/button\";\nimport { Check, X, Waves, Search, CheckCheck } from \"lucide-react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { useState, useMemo } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { cn } from \"@/lib/utils\";\n\ninterface ZoneSelectorProps {\n  selectedZoneIds: string[];\n  onZoneToggle: (zoneId: string) => void;\n  onGroupZones: () => void;\n  onUngroupZones: () => void;\n  compact?: boolean;\n}\n\nexport function ZoneSelector({ \n  selectedZoneIds, \n  onZoneToggle, \n  onGroupZones, \n  onUngroupZones,\n  compact = false \n}: ZoneSelectorProps) {\n  const { groups, currentGroup } = useSonos();\n  const [isOpen, setIsOpen] = useState(false);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n\n  // Filter zones based on search query\n  const filteredGroups = useMemo(() => {\n    if (!searchQuery.trim()) return groups;\n    const query = searchQuery.toLowerCase();\n    return groups.filter((group: any) => \n      group.name.toLowerCase().includes(query)\n    );\n  }, [groups, searchQuery]);\n\n  // Groups are the zones themselves - each group represents a zone/room\n  const hasMultipleSelected = selectedZoneIds.length > 1;\n  const canGroup = hasMultipleSelected && selectedZoneIds.length > 0;\n  const allSelected = selectedZoneIds.length === groups.length && groups.length > 0;\n\n  const handleSelectAll = () => {\n    if (allSelected) {\n      // Deselect all\n      selectedZoneIds.forEach(id => onZoneToggle(id));\n    } else {\n      // Select all filtered zones\n      filteredGroups.forEach((group: any) => {\n        if (!selectedZoneIds.includes(group.id)) {\n          onZoneToggle(group.id);\n        }\n      });\n    }\n  };\n\n  return (\n    <div className=\"relative\">\n      <Button\n        variant=\"ghost\"\n        onClick={() => setIsOpen(!isOpen)}\n        className={cn(\n          \"flex items-center gap-2 transition-all text-foreground hover:bg-foreground/10\",\n          compact ? \"h-10 px-3 text-xs\" : \"h-12 px-4\"\n        )}\n      >\n        <Waves className=\"h-4 w-4 text-foreground opacity-90\" />\n        <span className=\"font-black uppercase tracking-tight text-foreground opacity-90\">\n          {selectedZoneIds.length === 0 \n            ? \"Select Zones\" \n            : `${selectedZoneIds.length} Zone${selectedZoneIds.length > 1 ? \"s\" : \"\"}`\n          }\n        </span>\n      </Button>\n\n      {typeof window !== 'undefined' && createPortal(\n        <AnimatePresence>\n          {isOpen && (\n            <>\n              <div \n                className=\"fixed inset-0 z-[300] bg-black/70 backdrop-blur-md\"\n                onClick={() => setIsOpen(false)}\n              />\n              <motion.div\n                initial={{ opacity: 0, y: compact ? 20 : -20, scale: 0.95 }}\n                animate={{ opacity: 1, y: 0, scale: 1 }}\n                exit={{ opacity: 0, y: compact ? 20 : -20, scale: 0.95 }}\n                transition={{ duration: 0.2 }}\n                className={cn(\n                  \"fixed z-[301] bg-background backdrop-blur-2xl rounded-2xl border-2 border-foreground/20 shadow-2xl overflow-hidden flex flex-col\",\n                  compact \n                    ? \"bottom-[200px] right-4 sm:right-12 lg:right-20 w-[360px] max-w-[calc(100vw-2rem)]\" \n                    : \"top-20 right-4 sm:right-6 md:right-8 w-[420px] max-w-[calc(100vw-2rem)]\"\n                )}\n              >\n              {/* Header */}\n              <div className=\"p-5 pb-4 border-b border-foreground/10 shrink-0\">\n                <div className=\"flex items-center justify-between mb-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <h3 className=\"text-sm font-black uppercase tracking-[0.15em] text-foreground\">\n                      SELECT ZONES\n                    </h3>\n                    {selectedZoneIds.length > 0 && (\n                      <motion.div\n                        initial={{ scale: 0 }}\n                        animate={{ scale: 1 }}\n                        className=\"h-7 w-7 rounded-full bg-primary flex items-center justify-center shadow-md\"\n                      >\n                        <span className=\"text-xs font-black text-primary-foreground\">\n                          {selectedZoneIds.length}\n                        </span>\n                      </motion.div>\n                    )}\n                  </div>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    className=\"h-10 w-10 text-foreground hover:bg-foreground/10 active:scale-95 transition-all rounded-xl\"\n                    onClick={() => setIsOpen(false)}\n                  >\n                    <X className=\"h-5 w-5\" />\n                  </Button>\n                </div>\n\n                {/* Search Bar */}\n                <div className=\"relative mb-4\">\n                  <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground pointer-events-none\" />\n                  <input\n                    type=\"text\"\n                    placeholder=\"Search zones...\"\n                    value={searchQuery}\n                    onChange={(e) => setSearchQuery(e.target.value)}\n                    className=\"w-full pl-12 pr-4 py-3.5 bg-foreground/5 border-2 border-foreground/10 rounded-2xl text-base font-medium text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary/40 transition-all touch-manipulation\"\n                  />\n                </div>\n\n                {/* Quick Actions */}\n                <div className=\"flex items-center justify-between\">\n                  <Button\n                    variant=\"ghost\"\n                    onClick={handleSelectAll}\n                    className=\"h-11 px-4 text-xs font-black uppercase tracking-wider text-foreground/80 hover:text-foreground hover:bg-foreground/10 active:scale-95 transition-all rounded-xl touch-manipulation\"\n                  >\n                    <CheckCheck className=\"h-4 w-4 mr-2\" />\n                    {allSelected ? \"Deselect All\" : \"Select All\"}\n                  </Button>\n                  {filteredGroups.length !== groups.length && (\n                    <span className=\"text-xs font-black uppercase tracking-wider text-muted-foreground px-3 py-2 bg-foreground/5 rounded-xl\">\n                      {filteredGroups.length} of {groups.length}\n                    </span>\n                  )}\n                </div>\n              </div>\n\n              {/* Zones Grid */}\n              <div className=\"flex-1 overflow-y-auto no-scrollbar p-4 pb-5\">\n                {filteredGroups.length === 0 ? (\n                  <div className=\"flex flex-col items-center justify-center py-12 text-center\">\n                    <Waves className=\"h-12 w-12 text-muted-foreground opacity-20 mb-3\" />\n                    <p className=\"text-sm font-medium text-muted-foreground\">No zones found</p>\n                    <p className=\"text-xs text-muted-foreground opacity-70 mt-1\">Try a different search term</p>\n                  </div>\n                ) : (\n                  <div className=\"grid grid-cols-2 gap-2\">\n                    {filteredGroups.map((group: any, idx: number) => {\n                      const isSelected = selectedZoneIds.includes(group.id);\n                      const isPlaying = group.playbackState === \"PLAYBACK_STATE_PLAYING\";\n                      const isCurrent = currentGroup?.id === group.id;\n\n                      return (\n                        <motion.button\n                          key={group.id}\n                          onClick={() => onZoneToggle(group.id)}\n                          initial={{ opacity: 0, scale: 0.9 }}\n                          animate={{ opacity: 1, scale: 1 }}\n                          transition={{ delay: idx * 0.02 }}\n                          className={cn(\n                            \"relative flex flex-col items-center justify-center p-5 rounded-2xl transition-all border-2 min-h-[120px] touch-manipulation\",\n                            isSelected\n                              ? \"bg-foreground text-background border-foreground shadow-lg\"\n                              : \"bg-foreground/[0.03] border-transparent active:bg-foreground/[0.08] active:border-foreground/20 dark:active:bg-foreground/[0.12]\"\n                          )}\n                          whileHover={{ scale: 1.02 }}\n                          whileTap={{ scale: 0.95 }}\n                        >\n                          {/* Selection Indicator */}\n                          {isSelected && (\n                            <motion.div\n                              initial={{ scale: 0 }}\n                              animate={{ scale: 1 }}\n                              className=\"absolute top-3 right-3 h-7 w-7 rounded-full bg-background flex items-center justify-center shadow-lg\"\n                            >\n                              <Check className=\"h-4 w-4 text-foreground\" />\n                            </motion.div>\n                          )}\n\n                          {/* Icon */}\n                          <div className={cn(\n                            \"h-14 w-14 rounded-full flex items-center justify-center mb-3 transition-all\",\n                            isSelected \n                              ? \"bg-background/20\" \n                              : \"bg-foreground/[0.08] dark:bg-foreground/[0.12]\"\n                          )}>\n                            <Waves className={cn(\n                              \"h-7 w-7\",\n                              isSelected ? \"text-background\" : \"text-foreground opacity-70\"\n                            )} />\n                          </div>\n\n                          {/* Zone Name */}\n                          <span className={cn(\n                            \"text-sm font-black uppercase tracking-tight text-center leading-tight line-clamp-2\",\n                            isSelected ? \"text-background\" : \"text-foreground opacity-90\"\n                          )}>\n                            {group.name}\n                          </span>\n\n                          {/* Status Indicators */}\n                          <div className=\"flex items-center gap-1.5 mt-2\">\n                            {isPlaying && (\n                              <motion.div\n                                animate={{ opacity: [0.5, 1, 0.5] }}\n                                transition={{ repeat: Infinity, duration: 1.5 }}\n                                className=\"h-1.5 w-1.5 rounded-full bg-primary\"\n                              />\n                            )}\n                            {isCurrent && (\n                              <span className=\"text-[8px] font-black uppercase tracking-[0.1em] text-primary opacity-80\">\n                                Active\n                              </span>\n                            )}\n                          </div>\n                        </motion.button>\n                      );\n                    })}\n                  </div>\n                )}\n              </div>\n\n              {/* Footer Actions */}\n              {canGroup && (\n                <div className=\"p-5 pt-4 border-t border-foreground/10 shrink-0\">\n                  <div className=\"flex gap-3\">\n                    <Button\n                      variant=\"default\"\n                      onClick={() => {\n                        onGroupZones();\n                        setIsOpen(false);\n                      }}\n                      className=\"flex-1 h-12 text-sm font-black uppercase bg-foreground text-background hover:bg-foreground/90 active:scale-95 transition-all rounded-xl touch-manipulation\"\n                    >\n                      Group {selectedZoneIds.length} Zones\n                    </Button>\n                    {hasMultipleSelected && (\n                      <Button\n                        variant=\"ghost\"\n                        onClick={() => {\n                          onUngroupZones();\n                          setIsOpen(false);\n                        }}\n                        className=\"h-12 px-5 text-sm font-black uppercase text-foreground hover:bg-foreground/10 active:scale-95 transition-all rounded-xl touch-manipulation\"\n                      >\n                        Split\n                      </Button>\n                    )}\n                  </div>\n                </div>\n              )}\n              </motion.div>\n            </>\n          )}\n        </AnimatePresence>,\n        document.body\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3451, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/components/player/volume-control.tsx"],"sourcesContent":["\"use client\";\n\nimport { useSonos } from \"@/components/sonos-provider\";\nimport { Button } from \"@/components/ui/button\";\nimport { Slider } from \"@/components/ui/slider\";\nimport { X, Volume2, VolumeX, Volume1, ChevronDown, ChevronRight, Split, Plus, Settings2 } from \"lucide-react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { useState, useEffect } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { cn } from \"@/lib/utils\";\n\ninterface VolumeControlProps {\n  selectedZoneIds: string[];\n  compact?: boolean;\n}\n\ninterface PlayerVolume {\n  playerId: string;\n  name: string;\n  volume: number;\n}\n\ninterface ZoneVolumeData {\n  groupId: string;\n  groupName: string;\n  groupVolume: number;\n  players: PlayerVolume[];\n  isPlaying: boolean;\n  isExpanded: boolean;\n}\n\nexport function VolumeControl({ \n  selectedZoneIds,\n  compact = false \n}: VolumeControlProps) {\n  const { groups, refreshState, setCurrentGroup, setSelectedZoneIds, volume: currentVolume } = useSonos();\n  const [isOpen, setIsOpen] = useState(false);\n  const [zoneVolumes, setZoneVolumes] = useState<Record<string, ZoneVolumeData>>({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [editingGroupId, setEditingGroupId] = useState<string | null>(null);\n  const [selectedPlayersForEdit, setSelectedPlayersForEdit] = useState<string[]>([]);\n\n  // Fetch volumes for all selected zones and their players\n  useEffect(() => {\n    if (isOpen && selectedZoneIds.length > 0) {\n      fetchAllVolumes();\n    }\n  }, [isOpen, selectedZoneIds, currentVolume]);\n\n  const extractPlayersFromGroup = (group: any): PlayerVolume[] => {\n    const players: PlayerVolume[] = [];\n    const seenPlayerIds = new Set<string>();\n\n    console.log(\"Extracting players from group:\", group);\n\n    // Method 1: Extract from group.players array (most common)\n    if (group.players && Array.isArray(group.players)) {\n      console.log(\"Found group.players array:\", group.players);\n      group.players.forEach((player: any) => {\n        const playerId = player.id || player.playerId || player.player?.id || player.playerId;\n        const playerName = player.name || player.playerName || player.displayName || `Player ${playerId?.slice(-4) || 'Unknown'}`;\n        \n        console.log(\"Processing player:\", player, \"Extracted ID:\", playerId, \"Name:\", playerName);\n        \n        if (playerId && !seenPlayerIds.has(playerId)) {\n          seenPlayerIds.add(playerId);\n          players.push({\n            playerId,\n            name: playerName,\n            volume: 50, // Will be fetched\n          });\n        }\n      });\n    }\n\n    // Method 2: Extract from group.playerIds array\n    // Note: We'll update names later when we have access to allPlayers\n    if (group.playerIds && Array.isArray(group.playerIds)) {\n      console.log(\"Found group.playerIds array:\", group.playerIds);\n      group.playerIds.forEach((playerId: string) => {\n        if (playerId && !seenPlayerIds.has(playerId)) {\n          seenPlayerIds.add(playerId);\n          players.push({\n            playerId,\n            name: `Player ${playerId.slice(-4)}`, // Temporary, will be updated\n            volume: 50,\n          });\n        }\n      });\n    }\n\n    // Method 3: Check for coordinatorId field\n    if (group.coordinatorId && !seenPlayerIds.has(group.coordinatorId)) {\n      console.log(\"Found coordinatorId:\", group.coordinatorId);\n      seenPlayerIds.add(group.coordinatorId);\n      players.push({\n        playerId: group.coordinatorId,\n        name: group.name || `Player ${group.coordinatorId.slice(-4)}`,\n        volume: 50,\n      });\n    }\n\n    // Method 4: Extract coordinator from group ID (if no players found yet)\n    if (players.length === 0 && group.id && group.id.includes(':')) {\n      const coordinatorId = group.id.split(':')[0];\n      console.log(\"Extracting coordinator from group ID:\", coordinatorId);\n      players.push({\n        playerId: coordinatorId,\n        name: group.name || `Player ${coordinatorId.slice(-4)}`,\n        volume: 50,\n      });\n    }\n\n    // Method 5: If group has a single player (not grouped), use the group itself\n    // For grouped zones, we need to check if there are multiple players\n    // If the group name contains \"+\" or shows multiple speakers, try to get individual players\n    // For now, if we only found one player but the group name suggests multiple, \n    // we might need to fetch players separately\n    \n    console.log(\"Extracted players:\", players);\n    return players;\n  };\n\n  const fetchAllVolumes = async () => {\n    setIsLoading(true);\n    try {\n      const selectedZones = groups.filter((group: any) => \n        selectedZoneIds.includes(group.id)\n      );\n\n      // First, try to fetch all players from the household\n      let allPlayers: any[] = [];\n      try {\n        const playersRes = await fetch(\"/api/sonos/players\");\n        if (playersRes.ok) {\n          const playersData = await playersRes.json();\n          allPlayers = playersData.players || [];\n          console.log(\"Fetched all players:\", allPlayers);\n        }\n      } catch (error) {\n        console.error(\"Failed to fetch all players:\", error);\n      }\n\n      const volumeDataPromises = selectedZones.map(async (group: any) => {\n        console.log(\"Processing group for volume:\", group);\n        \n        // Fetch group volume - always fetch fresh from API\n        let groupVolume: number | null = null;\n        try {\n          const res = await fetch(`/api/sonos/volume?groupId=${group.id}`);\n          if (res.ok) {\n            const data = await res.json();\n            groupVolume = typeof data.volume === 'number' ? data.volume : null;\n            console.log(`Fetched volume for group ${group.id}: ${groupVolume}`);\n          } else {\n            const errorText = await res.text();\n            console.warn(`Failed to fetch volume for ${group.id}: ${res.status} - ${errorText}`);\n          }\n        } catch (error) {\n          console.error(`Failed to fetch group volume for ${group.id}:`, error);\n        }\n        \n        // Use fetched volume, or fallback to current volume from provider, or 50\n        const finalGroupVolume = groupVolume ?? currentVolume ?? 50;\n\n        // Extract players from group\n        let players = extractPlayersFromGroup(group);\n        \n        // Check if group name suggests multiple players (e.g., \"Office + 1\", \"Living Room + 2\")\n        const hasMultipleInName = group.name && (group.name.includes('+') || group.name.includes('&'));\n        const nameMatch = group.name?.match(/\\+ (\\d+)/);\n        const expectedPlayerCount = nameMatch ? parseInt(nameMatch[1]) + 1 : (hasMultipleInName ? 2 : 1);\n        \n        console.log(`Group \"${group.name}\" - Expected ${expectedPlayerCount} players, found ${players.length}`);\n        \n        // Get coordinator ID\n        const coordinatorId = group.coordinatorId || (group.id?.includes(':') ? group.id.split(':')[0] : group.id);\n        \n        // If group has playerIds array, use that as the source of truth and match with allPlayers for proper names\n        if (group.playerIds && Array.isArray(group.playerIds) && group.playerIds.length > 0) {\n          console.log(\"Using group.playerIds as source of truth:\", group.playerIds);\n          \n          // Clear existing players and rebuild from playerIds\n          const newPlayers: PlayerVolume[] = [];\n          \n          group.playerIds.forEach((pid: string) => {\n            // Try to find player in allPlayers by exact ID match first\n            let player = allPlayers.find((p: any) => p.id === pid || p.coordinatorId === pid);\n            \n            // If not found, try to find by matching the last part of the ID\n            if (!player) {\n              const pidSuffix = pid.slice(-4);\n              player = allPlayers.find((p: any) => {\n                const pId = p.id || p.coordinatorId || '';\n                return pId.includes(pidSuffix) || pid.includes(pId.slice(-4));\n              });\n            }\n            \n            // Also check if there's a matching group (ungrouped zones represent individual players)\n            if (!player) {\n              const matchingGroup = groups.find((g: any) => {\n                const gCoordinatorId = g.coordinatorId || (g.id?.includes(':') ? g.id.split(':')[0] : g.id);\n                return gCoordinatorId === pid && !g.name?.includes('+') && !g.name?.includes('&');\n              });\n              if (matchingGroup) {\n                player = { id: pid, name: matchingGroup.name, coordinatorId: pid };\n              }\n            }\n            \n            const playerName = player?.name || `Player ${pid.slice(-4)}`;\n            console.log(`Player ${pid} matched to: ${playerName}`, player);\n            \n            newPlayers.push({\n              playerId: pid,\n              name: playerName,\n              volume: 50,\n            });\n          });\n          \n          players.length = 0;\n          players.push(...newPlayers);\n        } else {\n          // If no playerIds, try to update names from allPlayers\n          players.forEach((p) => {\n            // Try exact match first\n            let player = allPlayers.find((ap: any) => \n              ap.id === p.playerId || \n              ap.coordinatorId === p.playerId\n            );\n            \n            // If not found, try partial match\n            if (!player) {\n              const pidSuffix = p.playerId.slice(-4);\n              player = allPlayers.find((ap: any) => {\n                const apId = ap.id || ap.coordinatorId || '';\n                return apId.includes(pidSuffix) || p.playerId.includes(apId.slice(-4));\n              });\n            }\n            \n            // Also check if there's a matching ungrouped group\n            if (!player) {\n              const matchingGroup = groups.find((g: any) => {\n                const gCoordinatorId = g.coordinatorId || (g.id?.includes(':') ? g.id.split(':')[0] : g.id);\n                return gCoordinatorId === p.playerId && !g.name?.includes('+') && !g.name?.includes('&');\n              });\n              if (matchingGroup) {\n                player = { id: p.playerId, name: matchingGroup.name, coordinatorId: p.playerId };\n              }\n            }\n            \n            if (player?.name && (p.name.startsWith('Player ') || p.name === group.name || !p.name)) {\n              p.name = player.name;\n              console.log(`Updated player ${p.playerId} name to: ${player.name}`);\n            }\n          });\n        }\n        \n        // If we still don't have enough players, try to find them from other groups\n        if (players.length < expectedPlayerCount && allPlayers.length > 0) {\n          \n          // If still not enough, try to find players by matching group names\n          // This is a fallback - try to find players whose names match parts of the group name\n          if (players.length < expectedPlayerCount && group.name) {\n            const groupNameParts = group.name.split(/[\\+\\&]/).map((s: string) => s.trim());\n            allPlayers.forEach((player: any) => {\n              if (players.length >= expectedPlayerCount) return;\n              \n              const playerName = player.name || '';\n              // Check if player name matches any part of the group name\n              const matches = groupNameParts.some((part: string) => \n                playerName.toLowerCase().includes(part.toLowerCase()) || \n                part.toLowerCase().includes(playerName.toLowerCase())\n              );\n              \n              if (matches && !players.find(p => p.playerId === player.id)) {\n                players.push({\n                  playerId: player.id,\n                  name: player.name || `Player ${player.id.slice(-4)}`,\n                  volume: 50,\n                });\n              }\n            });\n          }\n          \n          // Last resort: if we have coordinator but only one player, try to find other players\n          // by checking if there are other groups that might be part of this group\n          if (players.length === 1 && coordinatorId) {\n            // Check other groups to see if they're part of this grouped zone\n            groups.forEach((otherGroup: any) => {\n              if (otherGroup.id === group.id) return;\n              \n              const otherCoordinatorId = otherGroup.coordinatorId || (otherGroup.id?.includes(':') ? otherGroup.id.split(':')[0] : otherGroup.id);\n              // If the other group's coordinator is in our playerIds, it might be part of this group\n              if (group.playerIds && group.playerIds.includes(otherCoordinatorId)) {\n                const player = allPlayers.find((p: any) => p.id === otherCoordinatorId);\n                if (player && !players.find(p => p.playerId === otherCoordinatorId)) {\n                  players.push({\n                    playerId: otherCoordinatorId,\n                    name: otherGroup.name || player.name || `Player ${otherCoordinatorId.slice(-4)}`,\n                    volume: 50,\n                  });\n                }\n              }\n            });\n          }\n        }\n        \n        console.log(`Group ${group.name} (${group.id}) has ${players.length} players:`, players);\n\n        // Fetch individual player volumes\n        const playerVolumesPromises = players.map(async (player) => {\n          try {\n            console.log(`Fetching volume for player ${player.playerId} (${player.name})`);\n            const res = await fetch(`/api/sonos/player-volume?playerId=${player.playerId}`);\n            if (res.ok) {\n              const data = await res.json();\n              const playerVolume = typeof data.volume === 'number' ? data.volume : finalGroupVolume;\n              console.log(`Player ${player.playerId} volume: ${playerVolume}`);\n              return { ...player, volume: playerVolume };\n            } else {\n              const errorText = await res.text();\n              console.error(`Failed to fetch volume for player ${player.playerId}:`, res.status, errorText);\n              // Use group volume as fallback\n              return { ...player, volume: finalGroupVolume };\n            }\n          } catch (error) {\n            console.error(`Error fetching volume for player ${player.playerId}:`, error);\n            // Use group volume as fallback\n            return { ...player, volume: finalGroupVolume };\n          }\n        });\n\n        const playerVolumes = await Promise.all(playerVolumesPromises);\n\n        return {\n          groupId: group.id,\n          groupName: group.name,\n          groupVolume: finalGroupVolume,\n          players: playerVolumes,\n          isPlaying: group.playbackState === \"PLAYBACK_STATE_PLAYING\",\n          isExpanded: false, // Start collapsed\n        };\n      });\n\n      const volumes = await Promise.all(volumeDataPromises);\n      const volumeMap: Record<string, ZoneVolumeData> = {};\n      volumes.forEach((data) => {\n        volumeMap[data.groupId] = data;\n      });\n      setZoneVolumes(volumeMap);\n    } catch (error) {\n      console.error(\"Failed to fetch volumes:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleGroupVolumeChange = async (groupId: string, value: number[]) => {\n    const newVolume = value[0];\n    \n    // Update local state immediately for responsive UI\n    setZoneVolumes(prev => ({\n      ...prev,\n      [groupId]: { ...prev[groupId], groupVolume: newVolume }\n    }));\n    \n    try {\n      const res = await fetch(`/api/sonos/control?groupId=${groupId}&volume=${newVolume}`, { \n        method: \"POST\" \n      });\n      \n      if (res.status === 410) {\n        // Group no longer exists, refresh state but don't show loading\n        await refreshState();\n        // Silently update volume for this group only\n        try {\n          const volRes = await fetch(`/api/sonos/volume?groupId=${groupId}`);\n          if (volRes.ok) {\n            const data = await volRes.json();\n            setZoneVolumes(prev => ({\n              ...prev,\n              [groupId]: { ...prev[groupId], groupVolume: data.volume || 50 }\n            }));\n          }\n        } catch (e) {\n          console.error(\"Failed to refresh volume after 410:\", e);\n        }\n      } else if (!res.ok) {\n        // On error, revert the optimistic update\n        const errorText = await res.text();\n        console.error(`Failed to set group volume: ${res.status} ${errorText}`);\n        // Revert by fetching current volume\n        try {\n          const volRes = await fetch(`/api/sonos/volume?groupId=${groupId}`);\n          if (volRes.ok) {\n            const data = await volRes.json();\n            setZoneVolumes(prev => ({\n              ...prev,\n              [groupId]: { ...prev[groupId], groupVolume: data.volume || 50 }\n            }));\n          }\n        } catch (e) {\n          console.error(\"Failed to revert volume:\", e);\n        }\n      }\n      // On success, state is already updated optimistically, no need to reload\n    } catch (error) {\n      console.error(`Failed to set group volume for ${groupId}:`, error);\n      // Revert on error\n      try {\n        const volRes = await fetch(`/api/sonos/volume?groupId=${groupId}`);\n        if (volRes.ok) {\n          const data = await volRes.json();\n          setZoneVolumes(prev => ({\n            ...prev,\n            [groupId]: { ...prev[groupId], groupVolume: data.volume || 50 }\n          }));\n        }\n      } catch (e) {\n        console.error(\"Failed to revert volume:\", e);\n      }\n    }\n  };\n\n  const handlePlayerVolumeChange = async (groupId: string, playerId: string, value: number[]) => {\n    const newVolume = value[0];\n    \n    // Update local state immediately for responsive UI\n    setZoneVolumes(prev => ({\n      ...prev,\n      [groupId]: {\n        ...prev[groupId],\n        players: prev[groupId].players.map(p => \n          p.playerId === playerId ? { ...p, volume: newVolume } : p\n        )\n      }\n    }));\n    \n    try {\n      const res = await fetch(`/api/sonos/player-volume?playerId=${playerId}&volume=${newVolume}`, { \n        method: \"POST\" \n      });\n      \n      if (res.status === 410) {\n        // Player/group no longer exists, refresh state but don't show loading\n        await refreshState();\n        // Silently update volume for this player only\n        try {\n          const volRes = await fetch(`/api/sonos/player-volume?playerId=${playerId}`);\n          if (volRes.ok) {\n            const data = await volRes.json();\n            setZoneVolumes(prev => ({\n              ...prev,\n              [groupId]: {\n                ...prev[groupId],\n                players: prev[groupId].players.map(p => \n                  p.playerId === playerId ? { ...p, volume: data.volume || 50 } : p\n                )\n              }\n            }));\n          }\n        } catch (e) {\n          console.error(\"Failed to refresh volume after 410:\", e);\n        }\n      } else if (!res.ok) {\n        // On error, revert the optimistic update\n        const errorText = await res.text();\n        console.error(`Failed to set player volume: ${res.status} ${errorText}`);\n        // Revert by fetching current volume\n        try {\n          const volRes = await fetch(`/api/sonos/player-volume?playerId=${playerId}`);\n          if (volRes.ok) {\n            const data = await volRes.json();\n            setZoneVolumes(prev => ({\n              ...prev,\n              [groupId]: {\n                ...prev[groupId],\n                players: prev[groupId].players.map(p => \n                  p.playerId === playerId ? { ...p, volume: data.volume || 50 } : p\n                )\n              }\n            }));\n          }\n        } catch (e) {\n          console.error(\"Failed to revert volume:\", e);\n        }\n      }\n      // On success, state is already updated optimistically, no need to reload\n    } catch (error) {\n      console.error(`Failed to set player volume for ${playerId}:`, error);\n      // Revert on error\n      try {\n        const volRes = await fetch(`/api/sonos/player-volume?playerId=${playerId}`);\n        if (volRes.ok) {\n          const data = await volRes.json();\n          setZoneVolumes(prev => ({\n            ...prev,\n            [groupId]: {\n              ...prev[groupId],\n              players: prev[groupId].players.map(p => \n                p.playerId === playerId ? { ...p, volume: data.volume || 50 } : p\n              )\n            }\n          }));\n        }\n      } catch (e) {\n        console.error(\"Failed to revert volume:\", e);\n      }\n    }\n  };\n\n  const toggleZoneExpansion = (groupId: string) => {\n    setZoneVolumes(prev => ({\n      ...prev,\n      [groupId]: { ...prev[groupId], isExpanded: !prev[groupId].isExpanded }\n    }));\n  };\n\n  const handleSplitGroup = async (groupId: string) => {\n    const group = groups.find((g: any) => g.id === groupId);\n    if (!group) return;\n\n    // Get coordinator ID (first player in the group)\n    const coordinatorId = group.coordinatorId || (group.id?.includes(':') ? group.id.split(':')[0] : group.id);\n    \n    try {\n      // Split by setting group to only contain the coordinator\n      const res = await fetch(\"/api/sonos/groups\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          groupId: groupId,\n          playerIds: [coordinatorId], // Only coordinator = ungrouped\n        }),\n      });\n\n      if (!res.ok) {\n        const errorData = await res.json().catch(() => ({ error: \"Failed to parse error response\" }));\n        console.error(\"Split group error:\", errorData);\n        alert(`Failed to split group: ${errorData.error || errorData.details || \"Unknown error\"}`);\n        return;\n      }\n\n      await refreshState();\n      await fetchAllVolumes();\n    } catch (error: any) {\n      console.error(\"Failed to split group:\", error);\n      alert(`Failed to split group: ${error.message || \"Unknown error\"}`);\n    }\n  };\n\n  const handleEditGroup = (groupId: string) => {\n    const zoneData = zoneVolumes[groupId];\n    if (!zoneData) return;\n\n    // Initialize selected players with current group members (player IDs)\n    setSelectedPlayersForEdit(zoneData.players.map(p => p.playerId));\n    setEditingGroupId(groupId);\n  };\n\n  const handleSaveGroupEdit = async () => {\n    if (!editingGroupId) return;\n\n    try {\n      const res = await fetch(\"/api/sonos/groups\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          groupId: editingGroupId,\n          playerIds: selectedPlayersForEdit,\n        }),\n      });\n\n      if (!res.ok) {\n        const errorData = await res.json().catch(() => ({ error: \"Failed to parse error response\" }));\n        console.error(\"Edit group error:\", errorData);\n        alert(`Failed to update group: ${errorData.error || errorData.details || \"Unknown error\"}`);\n        return;\n      }\n\n      await refreshState();\n      await fetchAllVolumes();\n      setEditingGroupId(null);\n      setSelectedPlayersForEdit([]);\n    } catch (error: any) {\n      console.error(\"Failed to edit group:\", error);\n      alert(`Failed to edit group: ${error.message || \"Unknown error\"}`);\n    }\n  };\n\n  const handleCancelGroupEdit = () => {\n    setEditingGroupId(null);\n    setSelectedPlayersForEdit([]);\n  };\n\n  const togglePlayerInEdit = (playerId: string) => {\n    setSelectedPlayersForEdit(prev => {\n      if (prev.includes(playerId)) {\n        // Don't allow removing the last player\n        if (prev.length === 1) return prev;\n        return prev.filter(id => id !== playerId);\n      } else {\n        return [...prev, playerId];\n      }\n    });\n  };\n\n  const getVolumeIcon = (volume: number) => {\n    if (volume === 0) return VolumeX;\n    if (volume < 50) return Volume1;\n    return Volume2;\n  };\n\n  const getVolumeLabel = (volume: number) => {\n    if (volume === 0) return \"Muted\";\n    return `${Math.round(volume)}%`;\n  };\n\n  // Get zones that are selected\n  const selectedZones = groups.filter((group: any) => \n    selectedZoneIds.includes(group.id)\n  );\n\n  // Calculate average volume for display\n  // Use current volume from provider if available, otherwise calculate from zone volumes\n  const averageVolume = selectedZones.length > 0\n    ? Math.round(\n        selectedZones.reduce((sum: number, group: any) => {\n          const zoneData = zoneVolumes[group.id];\n          // Use zone volume if available, otherwise fall back to current volume or 50\n          return sum + (zoneData?.groupVolume ?? currentVolume ?? 50);\n        }, 0) / selectedZones.length\n      )\n    : (currentVolume ?? 50);\n\n  return (\n    <div className=\"relative\">\n      <Button\n        variant=\"ghost\"\n        onClick={() => setIsOpen(!isOpen)}\n        className={cn(\n          \"flex items-center gap-2 transition-all text-foreground hover:bg-foreground/10\",\n          compact ? \"h-10 px-3 text-xs\" : \"h-12 px-4\"\n        )}\n      >\n        <Volume2 className=\"h-4 w-4 text-foreground opacity-90\" />\n        <span className=\"font-black uppercase tracking-tight text-foreground opacity-90\">\n          {averageVolume}%\n        </span>\n      </Button>\n\n      {typeof window !== 'undefined' && createPortal(\n        <AnimatePresence>\n          {isOpen && (\n            <>\n              <div \n                className=\"fixed inset-0 z-[300] bg-black/70 backdrop-blur-md\"\n                onClick={() => setIsOpen(false)}\n              />\n                <motion.div\n                  initial={{ opacity: 0, y: compact ? 20 : -20, scale: 0.95 }}\n                  animate={{ opacity: 1, y: 0, scale: 1 }}\n                  exit={{ opacity: 0, y: compact ? 20 : -20, scale: 0.95 }}\n                  transition={{ duration: 0.2 }}\n                  className={cn(\n                    \"fixed z-[301] bg-background backdrop-blur-2xl rounded-3xl border-2 border-foreground/20 shadow-2xl overflow-hidden flex flex-col\",\n                    compact \n                      ? \"bottom-[200px] right-4 sm:right-12 lg:right-20 w-[440px] max-w-[calc(100vw-2rem)] max-h-[75vh]\" \n                      : \"bottom-24 right-4 sm:right-6 md:right-8 w-[520px] max-w-[calc(100vw-2rem)] max-h-[80vh]\"\n                  )}\n            >\n              {/* Header */}\n              <div className=\"p-6 pb-4 border-b border-foreground/10 shrink-0\">\n                <div className=\"flex items-center justify-between gap-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <h3 className=\"text-sm font-black uppercase tracking-[0.2em] text-foreground\">\n                      VOLUME CONTROL\n                    </h3>\n                    {selectedZoneIds.length > 0 && (\n                      <motion.div\n                        initial={{ scale: 0 }}\n                        animate={{ scale: 1 }}\n                        className=\"h-8 w-8 rounded-full bg-primary flex items-center justify-center shadow-md\"\n                      >\n                        <span className=\"text-xs font-black text-primary-foreground\">\n                          {selectedZoneIds.length}\n                        </span>\n                      </motion.div>\n                    )}\n                  </div>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    className=\"h-12 w-12 text-foreground hover:bg-foreground/10 active:scale-95 transition-all rounded-xl touch-manipulation\"\n                    onClick={() => setIsOpen(false)}\n                  >\n                    <X className=\"h-5 w-5\" />\n                  </Button>\n                </div>\n              </div>\n\n              {/* Zones Volume Controls */}\n              <div className=\"flex-1 overflow-y-auto no-scrollbar p-6 pb-6\">\n                {isLoading ? (\n                  <div className=\"flex flex-col items-center justify-center py-16 text-center\">\n                    <Volume2 className=\"h-16 w-16 text-muted-foreground opacity-20 mb-4 animate-pulse\" />\n                    <p className=\"text-base font-medium text-muted-foreground\">Loading volumes...</p>\n                  </div>\n                ) : selectedZones.length === 0 ? (\n                  <div className=\"flex flex-col items-center justify-center py-16 text-center\">\n                    <Volume2 className=\"h-16 w-16 text-muted-foreground opacity-20 mb-4\" />\n                    <p className=\"text-base font-medium text-muted-foreground\">No zones selected</p>\n                    <p className=\"text-sm text-muted-foreground opacity-70 mt-2\">Select zones to control volume</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-5\">\n                    {selectedZones.map((group: any, idx: number) => {\n                      const zoneData = zoneVolumes[group.id];\n                      if (!zoneData) return null;\n\n                      const { groupVolume, players, isPlaying, isExpanded } = zoneData;\n                      const VolumeIcon = getVolumeIcon(groupVolume);\n                      const hasPlayers = players.length > 0;\n\n                      return (\n                        <motion.div\n                          key={group.id}\n                          initial={{ opacity: 0, y: 10 }}\n                          animate={{ opacity: 1, y: 0 }}\n                          transition={{ delay: idx * 0.05 }}\n                          className=\"space-y-4 p-5 rounded-2xl bg-foreground/[0.03] border border-foreground/10 dark:bg-foreground/[0.05]\"\n                        >\n                          {/* Zone Header with Group Volume */}\n                          <div className=\"space-y-4\">\n                            <div className=\"flex items-center justify-between gap-3\">\n                              <div className=\"flex items-center gap-3 flex-1 min-w-0\">\n                                {hasPlayers && players.length > 1 && (\n                                  <Button\n                                    variant=\"ghost\"\n                                    size=\"icon\"\n                                    className=\"h-11 w-11 shrink-0 text-foreground hover:bg-foreground/10 active:scale-95 transition-all rounded-xl touch-manipulation\"\n                                    onClick={() => toggleZoneExpansion(group.id)}\n                                  >\n                                    {isExpanded ? (\n                                      <ChevronDown className=\"h-5 w-5\" />\n                                    ) : (\n                                      <ChevronRight className=\"h-5 w-5\" />\n                                    )}\n                                  </Button>\n                                )}\n                                {hasPlayers && players.length === 1 && (\n                                  <div className=\"h-11 w-11 shrink-0\" />\n                                )}\n                                <div className={cn(\n                                  \"h-12 w-12 rounded-full flex items-center justify-center transition-all shrink-0\",\n                                  isPlaying \n                                    ? \"bg-primary/20\" \n                                    : \"bg-foreground/[0.08] dark:bg-foreground/[0.12]\"\n                                )}>\n                                  <VolumeIcon className={cn(\n                                    \"h-6 w-6\",\n                                    isPlaying ? \"text-primary\" : \"text-foreground opacity-70\"\n                                  )} />\n                                </div>\n                                <div className=\"flex flex-col min-w-0 flex-1 gap-1\">\n                                  <span className=\"text-sm font-black uppercase tracking-tight text-foreground truncate leading-tight\">\n                                    {zoneData.groupName}\n                                  </span>\n                                  <span className=\"text-xs font-medium text-muted-foreground opacity-70 leading-tight\">\n                                    Group: {getVolumeLabel(groupVolume)}\n                                    {hasPlayers && `  ${players.length} speaker${players.length > 1 ? 's' : ''}`}\n                                  </span>\n                                </div>\n                              </div>\n                              {isPlaying && (\n                                <motion.div\n                                  animate={{ opacity: [0.5, 1, 0.5] }}\n                                  transition={{ repeat: Infinity, duration: 1.5 }}\n                                  className=\"h-2.5 w-2.5 rounded-full bg-primary shrink-0\"\n                                />\n                              )}\n                            </div>\n\n                            {/* Group Volume Slider */}\n                            <div className=\"flex items-center gap-4 px-2\">\n                              <VolumeX \n                                className={cn(\n                                  \"h-6 w-6 shrink-0 transition-colors touch-manipulation\",\n                                  groupVolume === 0 \n                                    ? \"text-foreground\" \n                                    : \"text-muted-foreground opacity-50\"\n                                )}\n                              />\n                              <Slider \n                                value={[groupVolume]} \n                                onValueChange={(value) => handleGroupVolumeChange(group.id, value)}\n                                max={100} \n                                step={1} \n                                className=\"flex-1 h-2.5 cursor-pointer touch-manipulation\" \n                              />\n                              <Volume2 \n                                className={cn(\n                                  \"h-6 w-6 shrink-0 transition-colors touch-manipulation\",\n                                  groupVolume > 0 \n                                    ? \"text-foreground\" \n                                    : \"text-muted-foreground opacity-50\"\n                                )}\n                              />\n                            </div>\n\n                            {/* Group Management Actions */}\n                            {hasPlayers && players.length > 1 && (\n                              <div className=\"flex items-center gap-2 pt-2 border-t border-foreground/10\">\n                                <Button\n                                  variant=\"ghost\"\n                                  size=\"sm\"\n                                  onClick={() => handleSplitGroup(group.id)}\n                                  className=\"h-10 px-4 text-xs font-black uppercase tracking-tight text-foreground hover:bg-foreground/10 active:scale-95 transition-all rounded-xl touch-manipulation flex items-center gap-2\"\n                                >\n                                  <Split className=\"h-4 w-4\" />\n                                  Split\n                                </Button>\n                                <Button\n                                  variant=\"ghost\"\n                                  size=\"sm\"\n                                  onClick={() => handleEditGroup(group.id)}\n                                  className=\"h-10 px-4 text-xs font-black uppercase tracking-tight text-foreground hover:bg-foreground/10 active:scale-95 transition-all rounded-xl touch-manipulation flex items-center gap-2\"\n                                >\n                                  <Settings2 className=\"h-4 w-4\" />\n                                  Edit Group\n                                </Button>\n                              </div>\n                            )}\n                          </div>\n\n                          {/* Individual Player Volumes (Expandable) */}\n                          {hasPlayers && players.length > 1 && (\n                            <AnimatePresence>\n                              {isExpanded && (\n                                <motion.div\n                                  initial={{ height: 0, opacity: 0 }}\n                                  animate={{ height: \"auto\", opacity: 1 }}\n                                  exit={{ height: 0, opacity: 0 }}\n                                  transition={{ duration: 0.2 }}\n                                  className=\"space-y-4 pt-4 border-t border-foreground/10 overflow-hidden\"\n                                >\n                                  {players.map((player, playerIdx) => {\n                                    const PlayerVolumeIcon = getVolumeIcon(player.volume);\n                                    return (\n                                      <motion.div\n                                        key={player.playerId}\n                                        initial={{ opacity: 0, x: -10 }}\n                                        animate={{ opacity: 1, x: 0 }}\n                                        transition={{ delay: playerIdx * 0.03 }}\n                                        className=\"space-y-3 pl-8\"\n                                      >\n                                        <div className=\"flex items-center justify-between gap-3\">\n                                          <div className=\"flex items-center gap-3 min-w-0 flex-1\">\n                                            <PlayerVolumeIcon className=\"h-5 w-5 shrink-0 text-muted-foreground opacity-70\" />\n                                            <span className=\"text-xs font-bold uppercase tracking-tight text-foreground opacity-90 truncate\">\n                                              {player.name}\n                                            </span>\n                                          </div>\n                                          <span className=\"text-xs font-medium text-muted-foreground opacity-70 shrink-0\">\n                                            {getVolumeLabel(player.volume)}\n                                          </span>\n                                        </div>\n                                        <div className=\"flex items-center gap-4 px-2\">\n                                          <VolumeX \n                                            className={cn(\n                                              \"h-5 w-5 shrink-0 transition-colors touch-manipulation\",\n                                              player.volume === 0 \n                                                ? \"text-foreground\" \n                                                : \"text-muted-foreground opacity-50\"\n                                            )}\n                                          />\n                                          <Slider \n                                            value={[player.volume]} \n                                            onValueChange={(value) => handlePlayerVolumeChange(group.id, player.playerId, value)}\n                                            max={100} \n                                            step={1} \n                                            className=\"flex-1 h-2 cursor-pointer touch-manipulation\" \n                                          />\n                                          <Volume2 \n                                            className={cn(\n                                              \"h-5 w-5 shrink-0 transition-colors touch-manipulation\",\n                                              player.volume > 0 \n                                                ? \"text-foreground\" \n                                                : \"text-muted-foreground opacity-50\"\n                                            )}\n                                          />\n                                        </div>\n                                      </motion.div>\n                                    );\n                                  })}\n                                </motion.div>\n                              )}\n                            </AnimatePresence>\n                          )}\n                          \n                          {/* Edit Group Mode */}\n                          {editingGroupId === group.id && (\n                            <motion.div\n                              initial={{ opacity: 0, height: 0 }}\n                              animate={{ opacity: 1, height: \"auto\" }}\n                              exit={{ opacity: 0, height: 0 }}\n                              className=\"pt-4 border-t border-foreground/10 space-y-4\"\n                            >\n                              <div className=\"flex items-center justify-between\">\n                                <h4 className=\"text-xs font-black uppercase tracking-tight text-foreground\">\n                                  Select Zones to Add\n                                </h4>\n                                <div className=\"flex items-center gap-2\">\n                                  <Button\n                                    variant=\"ghost\"\n                                    size=\"sm\"\n                                    onClick={handleCancelGroupEdit}\n                                    className=\"h-9 px-3 text-xs font-black uppercase tracking-tight text-muted-foreground hover:text-foreground hover:bg-foreground/10 active:scale-95 transition-all rounded-xl touch-manipulation\"\n                                  >\n                                    Cancel\n                                  </Button>\n                                  <Button\n                                    variant=\"default\"\n                                    size=\"sm\"\n                                    onClick={handleSaveGroupEdit}\n                                    disabled={selectedPlayersForEdit.length === 0}\n                                    className=\"h-9 px-4 text-xs font-black uppercase tracking-tight bg-foreground text-background hover:bg-foreground/90 active:scale-95 transition-all rounded-xl touch-manipulation disabled:opacity-50 disabled:cursor-not-allowed\"\n                                  >\n                                    Save ({selectedPlayersForEdit.length})\n                                  </Button>\n                                </div>\n                              </div>\n                              <div className=\"grid grid-cols-2 gap-2 max-h-[200px] overflow-y-auto no-scrollbar\">\n                                {groups.map((g: any) => {\n                                  // Get coordinator ID for this group (this is the player ID we need)\n                                  const gCoordinatorId = g.coordinatorId || (g.id?.includes(':') ? g.id.split(':')[0] : g.id);\n                                  \n                                  // Check if this player is already selected\n                                  // We need to check if the coordinator ID matches any selected player ID\n                                  const isSelected = selectedPlayersForEdit.includes(gCoordinatorId);\n                                  const isCurrentGroup = g.id === group.id;\n                                  \n                                  // Check if this zone is already part of the group being edited\n                                  const zoneData = zoneVolumes[group.id];\n                                  const isAlreadyInGroup = zoneData?.players.some(p => p.playerId === gCoordinatorId);\n                                  \n                                  return (\n                                    <motion.button\n                                      key={g.id}\n                                      onClick={() => togglePlayerInEdit(gCoordinatorId)}\n                                      disabled={isCurrentGroup && selectedPlayersForEdit.length === 1}\n                                      className={cn(\n                                        \"p-3 rounded-xl border-2 transition-all touch-manipulation text-left\",\n                                        isSelected\n                                          ? \"bg-foreground text-background border-foreground\"\n                                          : \"bg-foreground/[0.03] border-transparent hover:bg-foreground/[0.08]\",\n                                        isCurrentGroup && selectedPlayersForEdit.length === 1\n                                          ? \"opacity-50 cursor-not-allowed\"\n                                          : \"active:scale-95\"\n                                      )}\n                                    >\n                                      <div className=\"flex items-center gap-2\">\n                                        {isSelected && (\n                                          <div className=\"h-5 w-5 rounded-full bg-background flex items-center justify-center shrink-0\">\n                                            <div className=\"h-2.5 w-2.5 rounded-full bg-foreground\" />\n                                          </div>\n                                        )}\n                                        <span className={cn(\n                                          \"text-xs font-bold uppercase tracking-tight truncate\",\n                                          isSelected ? \"text-background\" : \"text-foreground\"\n                                        )}>\n                                          {g.name}\n                                        </span>\n                                      </div>\n                                    </motion.button>\n                                  );\n                                })}\n                              </div>\n                            </motion.div>\n                          )}\n                        </motion.div>\n                      );\n                    })}\n                  </div>\n                )}\n              </div>\n            </motion.div>\n            </>\n          )}\n        </AnimatePresence>,\n        document.body\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4770, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/components/player/full-screen-player.tsx"],"sourcesContent":["\"use client\";\n\nimport { useSonos } from \"@/components/sonos-provider\";\nimport { Button } from \"@/components/ui/button\";\nimport { Slider } from \"@/components/ui/slider\";\nimport { ZoneSelector } from \"./zone-selector\";\nimport { VolumeControl } from \"./volume-control\";\nimport { ChevronDown, Play, Pause, SkipBack, SkipForward, Repeat, Shuffle, Heart, ListMusic } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { motion } from \"framer-motion\";\nimport { useState, useEffect } from \"react\";\n\nfunction formatTime(milliseconds: number): string {\n  const totalSeconds = Math.floor(milliseconds / 1000);\n  const minutes = Math.floor(totalSeconds / 60);\n  const seconds = totalSeconds % 60;\n  return `${minutes}:${seconds.toString().padStart(2, \"0\")}`;\n}\n\nexport function FullScreenPlayer({ onClose }: { onClose: () => void }) {\n  const { \n    currentGroup, \n    playbackState, \n    volume, \n    setVolume, \n    refreshState, \n    setIsExpanded,\n    groups,\n    selectedZoneIds,\n    toggleZone,\n    setCurrentGroup,\n    setSelectedZoneIds,\n  } = useSonos();\n  const [currentPosition, setCurrentPosition] = useState(0);\n  const [shuffleEnabled, setShuffleEnabled] = useState(false);\n  const [repeatEnabled, setRepeatEnabled] = useState(false);\n\n  const track = playbackState?.currentItem?.track;\n  const container = playbackState?.container;\n  const metadata = track || container || playbackState?.currentItem;\n  // Check multiple possible field names for playback state\n  const isPlaying = \n    playbackState?.playbackState === \"PLAYBACK_STATE_PLAYING\" ||\n    playbackState?.state === \"PLAYBACK_STATE_PLAYING\" ||\n    playbackState?.playbackState === \"PLAYING\" ||\n    playbackState?.state === \"PLAYING\";\n  \n  const artwork = track?.imageUrl || container?.imageUrl || metadata?.imageUrl;\n  const title = track?.name || container?.name || metadata?.name || \"No Music Playing\";\n  \n  // Extract artist - Sonos API structure: currentItem.track.artist.name\n  const artist = \n    track?.artist?.name || \n    track?.podcast?.name || \n    container?.name || \n    \"Unknown Artist\";\n  \n  // Extract position and duration from playback state\n  const positionMillis = playbackState?.positionMillis || playbackState?.playbackPositionMillis || 0;\n  const durationMillis = playbackState?.durationMillis || metadata?.durationMillis || playbackState?.currentItem?.track?.durationMillis || 0;\n  \n  // Extract play modes from playback state\n  useEffect(() => {\n    if (playbackState?.playModes) {\n      setShuffleEnabled(playbackState.playModes.shuffle ?? false);\n      setRepeatEnabled(playbackState.playModes.repeat ?? false);\n    }\n  }, [playbackState?.playModes]);\n  \n  // Update current position when playback state changes\n  useEffect(() => {\n    if (positionMillis !== undefined && positionMillis !== null) {\n      setCurrentPosition(positionMillis);\n    }\n  }, [positionMillis]);\n\n  // Auto-update position while playing\n  useEffect(() => {\n    if (!isPlaying || durationMillis === 0) return;\n    \n    const interval = setInterval(() => {\n      setCurrentPosition((prev) => {\n        const next = prev + 1000;\n        return next >= durationMillis ? durationMillis : next;\n      });\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, [isPlaying, durationMillis]);\n\n  const progress = durationMillis > 0 ? (currentPosition / durationMillis) * 100 : 0;\n\n  const handleClose = () => {\n    setIsExpanded(false);\n    onClose();\n  };\n\n  const handleGroupZones = async () => {\n    if (selectedZoneIds.length < 2) return;\n    \n    try {\n      console.log(\"Selected zone IDs:\", selectedZoneIds);\n      console.log(\"Groups:\", groups);\n\n      // Get player IDs from selected groups\n      // Groups contain player information - extract player IDs from group structure\n      const playerIds: string[] = [];\n      \n      for (const zoneId of selectedZoneIds) {\n        const group = groups.find((g: any) => g.id === zoneId);\n        console.log(`Processing zone ${zoneId}:`, group);\n        \n        if (group) {\n          // Method 1: Groups have a players array - extract player IDs\n          if (group.players && Array.isArray(group.players)) {\n            group.players.forEach((player: any) => {\n              // Player ID can be in different formats\n              const playerId = player.id || player.playerId || player.player?.id;\n              console.log(`Found player in group.players:`, player, `ID: ${playerId}`);\n              if (playerId && !playerIds.includes(playerId)) {\n                playerIds.push(playerId);\n              }\n            });\n          }\n          \n          // Method 2: Check for playerIds array directly\n          if (group.playerIds && Array.isArray(group.playerIds)) {\n            group.playerIds.forEach((pid: string) => {\n              console.log(`Found playerId in group.playerIds: ${pid}`);\n              if (pid && !playerIds.includes(pid)) {\n                playerIds.push(pid);\n              }\n            });\n          }\n          \n          // Method 3: Extract from group ID itself (group ID format: RINCON_xxx:timestamp)\n          // The group ID itself contains the player ID before the colon\n          if (group.id && group.id.includes(':')) {\n            const groupPlayerId = group.id.split(':')[0];\n            console.log(`Extracted player ID from group ID: ${groupPlayerId}`);\n            if (groupPlayerId && !playerIds.includes(groupPlayerId)) {\n              playerIds.push(groupPlayerId);\n            }\n          }\n          \n          // Method 4: If group has coordinator, use that\n          if (group.coordinatorId && !playerIds.includes(group.coordinatorId)) {\n            console.log(`Found coordinatorId: ${group.coordinatorId}`);\n            playerIds.push(group.coordinatorId);\n          }\n        }\n      }\n\n      if (playerIds.length === 0) {\n        console.error(\"No player IDs found for selected zones\");\n        return;\n      }\n\n      // Use the first selected group as the target group (this becomes the master group)\n      const targetGroupId = selectedZoneIds[0];\n      \n      console.log(\"Grouping zones:\", { targetGroupId, playerIds });\n      \n      const res = await fetch(\"/api/sonos/groups\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          groupId: targetGroupId,\n          playerIds: playerIds,\n        }),\n      });\n\n      if (!res.ok) {\n        const errorData = await res.json().catch(() => ({ error: \"Failed to parse error response\" }));\n        console.error(\"Group API error:\", {\n          status: res.status,\n          statusText: res.statusText,\n          error: errorData\n        });\n        alert(`Failed to group zones: ${errorData.error || errorData.details || \"Unknown error\"}`);\n        return;\n      }\n\n      // After grouping, refresh state to get the new group structure\n      await refreshState();\n      \n      // Wait a bit for Sonos to update the group structure\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      // Update currentGroup to the newly grouped zone so all controls use it\n      await refreshState();\n      const updatedGroups = await fetch(\"/api/sonos/state\").then(r => r.json()).then(d => d.groups || []);\n      const groupedZone = updatedGroups.find((g: any) => g.id === targetGroupId);\n      if (groupedZone) {\n        // Set the grouped zone as current and selected\n        setCurrentGroup(groupedZone);\n        setSelectedZoneIds([targetGroupId]);\n      }\n    } catch (error) {\n      console.error(\"Failed to group zones:\", error);\n    }\n  };\n\n  const handleUngroupZones = async () => {\n    try {\n      await refreshState();\n    } catch (error) {\n      console.error(\"Failed to ungroup zones:\", error);\n    }\n  };\n\n  const handleMultiZoneControl = async (command: \"play\" | \"pause\" | \"skipToNextTrack\" | \"skipToPreviousTrack\") => {\n    // If only one zone is selected, or if zones are grouped, control the single group\n    // This ensures grouped zones play the same content synchronously\n    if (selectedZoneIds.length === 1 || selectedZoneIds.length === 0) {\n      const groupId = selectedZoneIds[0] || currentGroup?.id;\n      if (!groupId) return;\n      \n      const res = await fetch(`/api/sonos/control?groupId=${groupId}&command=${command}`, { method: \"POST\" });\n      if (res.ok) {\n        await refreshState();\n        setTimeout(() => refreshState(), 500);\n      }\n      return;\n    }\n\n    // If multiple zones are selected but NOT grouped, group them first\n    // This ensures they play the same content\n    if (selectedZoneIds.length > 1) {\n      // Group the zones first, then control the group\n      await handleGroupZones();\n      // After grouping, control will use the single grouped zone\n      const groupId = selectedZoneIds[0];\n      if (groupId) {\n        const res = await fetch(`/api/sonos/control?groupId=${groupId}&command=${command}`, { method: \"POST\" });\n        if (res.status === 410) {\n          // Group no longer exists, refresh state\n          await refreshState();\n        } else if (res.ok) {\n          await refreshState();\n          setTimeout(() => refreshState(), 500);\n        }\n      }\n    }\n  };\n\n  const togglePlayback = async () => {\n    const command = isPlaying ? \"pause\" : \"play\";\n    await handleMultiZoneControl(command);\n  };\n\n  const skip = async (direction: \"skipToNextTrack\" | \"skipToPreviousTrack\") => {\n    await handleMultiZoneControl(direction);\n  };\n\n\n  const handleSeek = async (value: number[]) => {\n    if (!currentGroup || durationMillis === 0) return;\n    const seekPercent = value[0] / 100;\n    const seekPosition = Math.floor(durationMillis * seekPercent);\n    setCurrentPosition(seekPosition);\n    \n    // Send seek command to Sonos\n    try {\n      const res = await fetch(`/api/sonos/seek?groupId=${currentGroup.id}&positionMillis=${seekPosition}`, { method: \"POST\" });\n      if (res.status === 410) {\n        // Group no longer exists, refresh state\n        await refreshState();\n      } else if (res.ok) {\n        // Immediately refresh, then refresh again after a delay\n        await refreshState();\n        setTimeout(() => {\n          refreshState();\n        }, 500);\n      } else {\n        const errorData = await res.json().catch(() => ({}));\n        console.error(\"Seek failed:\", errorData);\n      }\n    } catch (error) {\n      console.error(\"Seek failed:\", error);\n    }\n  };\n\n  const toggleShuffle = async () => {\n    if (!currentGroup) return;\n    const newShuffle = !shuffleEnabled;\n    setShuffleEnabled(newShuffle);\n    try {\n      const res = await fetch(`/api/sonos/control?groupId=${currentGroup.id}&shuffle=${newShuffle}`, { method: \"POST\" });\n      if (res.ok) {\n        await refreshState();\n      } else {\n        // Revert on error\n        setShuffleEnabled(!newShuffle);\n      }\n    } catch (error) {\n      console.error(\"Failed to toggle shuffle:\", error);\n      setShuffleEnabled(!newShuffle);\n    }\n  };\n\n  const toggleRepeat = async () => {\n    if (!currentGroup) return;\n    const newRepeat = !repeatEnabled;\n    setRepeatEnabled(newRepeat);\n    try {\n      const res = await fetch(`/api/sonos/control?groupId=${currentGroup.id}&repeat=${newRepeat}`, { method: \"POST\" });\n      if (res.ok) {\n        await refreshState();\n      } else {\n        // Revert on error\n        setRepeatEnabled(!newRepeat);\n      }\n    } catch (error) {\n      console.error(\"Failed to toggle repeat:\", error);\n      setRepeatEnabled(!newRepeat);\n    }\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, scale: 1.05 }}\n      animate={{ opacity: 1, scale: 1 }}\n      exit={{ opacity: 0, scale: 0.98 }}\n      transition={{ duration: 0.6, ease: [0.22, 1, 0.36, 1] }}\n      className=\"fixed inset-0 z-[200] bg-background flex flex-col p-6 sm:p-10 md:p-12 overflow-hidden select-none\"\n    >\n      {/* Immersive Dynamic Background */}\n      <div className=\"absolute inset-0 z-[-1] overflow-hidden pointer-events-none\">\n        {artwork ? (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 0.5 }}\n            transition={{ duration: 1.5 }}\n            className=\"relative h-full w-full\"\n          >\n            <img \n              src={artwork} \n              alt=\"Background\" \n              className=\"w-full h-full object-cover blur-[120px] saturate-[1.5] brightness-[0.3] scale-110\"\n            />\n            <div className=\"absolute inset-0 bg-gradient-to-b from-black/20 via-transparent to-background\" />\n          </motion.div>\n        ) : (\n          <div className=\"h-full w-full bg-secondary/10\" />\n        )}\n      </div>\n\n      {/* Header - Fixed Height */}\n      <header className=\"w-full max-w-7xl mx-auto flex items-center justify-between z-10 shrink-0 h-20 sm:h-24\">\n        <Button \n          variant=\"ghost\" \n          size=\"icon\" \n          onClick={handleClose}\n          className=\"h-12 w-12 sm:h-14 sm:w-14 rounded-2xl glass hover:bg-white/10 transition-all duration-500 group\"\n        >\n          <ChevronDown className=\"h-8 w-8 group-hover:translate-y-1 transition-transform\" />\n        </Button>\n        \n        <div className=\"text-center flex-1 flex flex-col items-center\">\n          <p className=\"text-[10px] font-black uppercase tracking-[0.5em] text-primary mb-1 opacity-70 dark:opacity-60\">Atmosphere</p>\n          <h2 className=\"text-lg sm:text-xl font-black italic uppercase tracking-tighter leading-none truncate max-w-[200px] sm:max-w-md\">\n            {selectedZoneIds.length > 1 \n              ? `${selectedZoneIds.length} Zones` \n              : currentGroup?.name || \"No Zone Selected\"\n            }\n          </h2>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <ZoneSelector\n            selectedZoneIds={selectedZoneIds}\n            onZoneToggle={toggleZone}\n            onGroupZones={handleGroupZones}\n            onUngroupZones={handleUngroupZones}\n            compact={false}\n          />\n          <Button \n            variant=\"ghost\" \n            size=\"icon\" \n            className=\"h-12 w-12 sm:h-14 sm:w-14 rounded-2xl glass hover:bg-white/10 transition-all duration-500\"\n          >\n            <ListMusic className=\"h-6 w-6\" />\n          </Button>\n        </div>\n      </header>\n\n      {/* Main Experience - Flex Growing Area */}\n      <main className=\"w-full max-w-7xl mx-auto flex-1 min-h-0 flex flex-col lg:flex-row items-center justify-center gap-8 md:gap-12 lg:gap-20 z-10 py-4 sm:py-8 overflow-y-auto no-scrollbar\">\n        {/* Artwork - Constrained by height */}\n        <div className=\"flex-1 flex items-center justify-center w-full min-h-0 max-h-[40vh] lg:max-h-[60vh]\">\n          <motion.div \n            layoutId=\"artwork\"\n            className=\"relative aspect-square h-full max-w-full rounded-[2.5rem] lg:rounded-[4rem] overflow-hidden shadow-[0_40px_100px_-20px_rgba(0,0,0,0.5)] border border-white/5 bg-secondary/20\"\n          >\n            {artwork ? (\n              <img src={artwork} alt={title} className=\"w-full h-full object-cover\" />\n            ) : (\n              <div className=\"w-full h-full flex items-center justify-center italic\">\n                <span className=\"text-foreground/5 text-9xl font-black\">S</span>\n              </div>\n            )}\n          </motion.div>\n        </div>\n\n        {/* Info & Controls - Flex shrinkable */}\n        <div className=\"flex-1 flex flex-col justify-center w-full max-w-2xl text-center lg:text-left space-y-8 sm:space-y-12 shrink-0\">\n          <div className=\"space-y-4\">\n            <motion.div\n              initial={{ x: -20, opacity: 0 }}\n              animate={{ x: 0, opacity: 1 }}\n              transition={{ delay: 0.3 }}\n              className=\"space-y-2 sm:space-y-4\"\n            >\n              <h1 className=\"text-4xl sm:text-5xl md:text-6xl xl:text-7xl 2xl:text-8xl font-black tracking-tighter italic uppercase leading-[0.9] text-balance\">{title}</h1>\n              <div className=\"flex flex-col lg:flex-row lg:items-center gap-3 lg:gap-8\">\n                <p className=\"text-xl sm:text-2xl font-bold text-foreground/40 tracking-tight uppercase italic truncate\">{artist}</p>\n                <div className=\"hidden lg:block h-px w-12 bg-primary/20\" />\n                <div className=\"flex items-center justify-center gap-4\">\n                  <span className=\"text-[9px] font-black uppercase tracking-[0.3em] px-3 py-1 glass rounded-full text-primary border-primary/20\">Ultra HD</span>\n                  <Heart className=\"h-6 w-6 text-muted-foreground opacity-60 dark:opacity-50 hover:text-red-500 transition-colors cursor-pointer\" />\n                </div>\n              </div>\n            </motion.div>\n          </div>\n\n          <div className=\"space-y-8 sm:space-y-12\">\n            {/* Progress */}\n            <div className=\"space-y-4 sm:space-y-6\">\n              <Slider \n                value={[progress]} \n                onValueChange={handleSeek}\n                max={100} \n                step={0.1} \n                className=\"w-full h-1.5 sm:h-2 cursor-pointer\" \n              />\n              <div className=\"flex justify-between text-[10px] font-black tracking-[0.3em] text-muted-foreground opacity-70 dark:opacity-60 uppercase\">\n                <span>{formatTime(currentPosition)}</span>\n                <span>{formatTime(durationMillis)}</span>\n              </div>\n            </div>\n\n            {/* Controls */}\n            <div className=\"flex items-center justify-between lg:justify-start lg:gap-12\">\n              <Button \n                variant=\"ghost\" \n                size=\"icon\" \n                onClick={toggleShuffle}\n                className={cn(\n                  \"h-10 w-10 transition-all\",\n                  shuffleEnabled \n                    ? \"text-primary opacity-100\" \n                    : \"text-muted-foreground opacity-70 dark:opacity-60 hover:text-primary\"\n                )}\n              >\n                <Shuffle className=\"h-6 w-6\" />\n              </Button>\n              \n              <div className=\"flex items-center gap-8 sm:gap-12\">\n                <Button \n                  variant=\"ghost\" \n                  size=\"icon\" \n                  className=\"h-14 w-14 text-foreground/40 hover:text-foreground transition-all hover:scale-110 active:scale-95\"\n                  onClick={() => skip(\"skipToPreviousTrack\")}\n                >\n                  <SkipBack className=\"h-10 w-10 fill-current\" />\n                </Button>\n                \n                <Button \n                  variant=\"default\" \n                  size=\"icon\" \n                  className=\"h-24 w-24 sm:h-32 sm:w-32 rounded-[2.5rem] sm:rounded-[3.5rem] bg-foreground text-background hover:scale-105 active:scale-90 transition-all shadow-2xl border-4 border-white/5 shrink-0\" \n                  onClick={togglePlayback}\n                >\n                  {isPlaying ? <Pause className=\"h-10 w-10 sm:h-14 sm:w-14 fill-current\" /> : <Play className=\"h-10 w-10 sm:h-14 sm:w-14 fill-current ml-1.5\" />}\n                </Button>\n                \n                <Button \n                  variant=\"ghost\" \n                  size=\"icon\" \n                  className=\"h-14 w-14 text-foreground/40 hover:text-foreground transition-all hover:scale-110 active:scale-95\"\n                  onClick={() => skip(\"skipToNextTrack\")}\n                >\n                  <SkipForward className=\"h-10 w-10 fill-current\" />\n                </Button>\n              </div>\n\n              <Button \n                variant=\"ghost\" \n                size=\"icon\" \n                onClick={toggleRepeat}\n                className={cn(\n                  \"h-10 w-10 transition-all\",\n                  repeatEnabled \n                    ? \"text-primary opacity-100\" \n                    : \"text-muted-foreground opacity-70 dark:opacity-60 hover:text-primary\"\n                )}\n              >\n                <Repeat className=\"h-6 w-6\" />\n              </Button>\n            </div>\n          </div>\n        </div>\n      </main>\n\n      {/* Footer - Fixed Height */}\n      <footer className=\"w-full max-w-7xl mx-auto flex flex-col sm:flex-row items-center justify-between gap-6 sm:gap-10 z-10 pt-6 sm:pt-10 border-t border-white/5 shrink-0 h-32 sm:h-24 mb-4 sm:mb-0\">\n        <div className=\"flex items-center gap-3 w-full sm:w-auto px-6 py-3 glass rounded-2xl\" onClick={(e) => e.stopPropagation()}>\n          <VolumeControl\n            selectedZoneIds={selectedZoneIds.length > 0 ? selectedZoneIds : (currentGroup ? [currentGroup.id] : [])}\n            compact={false}\n          />\n        </div>\n        \n      </footer>\n    </motion.div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5572, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/components/player/mini-player.tsx"],"sourcesContent":["\"use client\";\n\nimport { useSonos } from \"@/components/sonos-provider\";\nimport { Button } from \"@/components/ui/button\";\nimport { Play, Pause, SkipBack, SkipForward, Maximize2, Heart, Disc, Shuffle, Repeat } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { FullScreenPlayer } from \"./full-screen-player\";\nimport { ZoneSelector } from \"./zone-selector\";\nimport { VolumeControl } from \"./volume-control\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { useState, useEffect } from \"react\";\n\nexport function MiniPlayer() {\n  const { \n    currentGroup, \n    playbackState, \n    volume, \n    setVolume, \n    refreshState, \n    isExpanded, \n    setIsExpanded,\n    groups,\n    selectedZoneIds,\n    toggleZone,\n    setCurrentGroup,\n    setSelectedZoneIds,\n  } = useSonos();\n  const [shuffleEnabled, setShuffleEnabled] = useState(false);\n  const [repeatEnabled, setRepeatEnabled] = useState(false);\n\n  // Extract play modes from playback state - MUST be before early return\n  useEffect(() => {\n    if (playbackState?.playModes) {\n      setShuffleEnabled(playbackState.playModes.shuffle ?? false);\n      setRepeatEnabled(playbackState.playModes.repeat ?? false);\n    }\n  }, [playbackState?.playModes]);\n\n  if (!currentGroup) return null;\n\n  const track = playbackState?.currentItem?.track;\n  const container = playbackState?.container;\n  const metadata = track || container || playbackState?.currentItem;\n  // Check multiple possible field names for playback state\n  const isPlaying = \n    playbackState?.playbackState === \"PLAYBACK_STATE_PLAYING\" ||\n    playbackState?.state === \"PLAYBACK_STATE_PLAYING\" ||\n    playbackState?.playbackState === \"PLAYING\" ||\n    playbackState?.state === \"PLAYING\";\n  \n  const artwork = track?.imageUrl || container?.imageUrl || metadata?.imageUrl;\n  const title = track?.name || container?.name || metadata?.name || \"No Music Playing\";\n  \n  // Extract artist - Sonos API structure: currentItem.track.artist.name\n  const artist = \n    track?.artist?.name || \n    track?.podcast?.name || \n    container?.name || \n    \"Unknown Artist\";\n\n  const togglePlayback = async (e: React.MouseEvent) => {\n    e.stopPropagation();\n    const command = isPlaying ? \"pause\" : \"play\";\n    await handleMultiZoneControl(command);\n  };\n\n  const skip = async (e: React.MouseEvent, direction: \"skipToNextTrack\" | \"skipToPreviousTrack\") => {\n    e.stopPropagation();\n    await handleMultiZoneControl(direction);\n  };\n\n\n  const handleGroupZones = async () => {\n    if (selectedZoneIds.length < 2) return;\n    \n    try {\n      console.log(\"Selected zone IDs:\", selectedZoneIds);\n      console.log(\"Groups:\", groups);\n\n      // Get player IDs from selected groups\n      // Groups contain player information - extract player IDs from group structure\n      const playerIds: string[] = [];\n      \n      for (const zoneId of selectedZoneIds) {\n        const group = groups.find((g: any) => g.id === zoneId);\n        console.log(`Processing zone ${zoneId}:`, group);\n        \n        if (group) {\n          // Method 1: Groups have a players array - extract player IDs\n          if (group.players && Array.isArray(group.players)) {\n            group.players.forEach((player: any) => {\n              // Player ID can be in different formats\n              const playerId = player.id || player.playerId || player.player?.id;\n              console.log(`Found player in group.players:`, player, `ID: ${playerId}`);\n              if (playerId && !playerIds.includes(playerId)) {\n                playerIds.push(playerId);\n              }\n            });\n          }\n          \n          // Method 2: Check for playerIds array directly\n          if (group.playerIds && Array.isArray(group.playerIds)) {\n            group.playerIds.forEach((pid: string) => {\n              console.log(`Found playerId in group.playerIds: ${pid}`);\n              if (pid && !playerIds.includes(pid)) {\n                playerIds.push(pid);\n              }\n            });\n          }\n          \n          // Method 3: Extract from group ID itself (group ID format: RINCON_xxx:timestamp)\n          // The group ID itself contains the player ID before the colon\n          if (group.id && group.id.includes(':')) {\n            const groupPlayerId = group.id.split(':')[0];\n            console.log(`Extracted player ID from group ID: ${groupPlayerId}`);\n            if (groupPlayerId && !playerIds.includes(groupPlayerId)) {\n              playerIds.push(groupPlayerId);\n            }\n          }\n          \n          // Method 4: If group has coordinator, use that\n          if (group.coordinatorId && !playerIds.includes(group.coordinatorId)) {\n            console.log(`Found coordinatorId: ${group.coordinatorId}`);\n            playerIds.push(group.coordinatorId);\n          }\n        }\n      }\n\n      if (playerIds.length === 0) {\n        console.error(\"No player IDs found for selected zones\");\n        return;\n      }\n\n      // Use the first selected group as the target group (this becomes the master group)\n      const targetGroupId = selectedZoneIds[0];\n      \n      console.log(\"Grouping zones:\", { targetGroupId, playerIds });\n      \n      const res = await fetch(\"/api/sonos/groups\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          groupId: targetGroupId,\n          playerIds: playerIds,\n        }),\n      });\n\n      if (!res.ok) {\n        const errorData = await res.json().catch(() => ({ error: \"Failed to parse error response\" }));\n        console.error(\"Group API error:\", {\n          status: res.status,\n          statusText: res.statusText,\n          error: errorData\n        });\n        alert(`Failed to group zones: ${errorData.error || errorData.details || \"Unknown error\"}`);\n        return;\n      }\n\n      // After grouping, refresh state to get the new group structure\n      await refreshState();\n      \n      // Wait a bit for Sonos to update the group structure\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      // Update currentGroup to the newly grouped zone so all controls use it\n      await refreshState();\n      const updatedGroups = await fetch(\"/api/sonos/state\").then(r => r.json()).then(d => d.groups || []);\n      const groupedZone = updatedGroups.find((g: any) => g.id === targetGroupId);\n      if (groupedZone) {\n        // Set the grouped zone as current and selected\n        setCurrentGroup(groupedZone);\n        setSelectedZoneIds([targetGroupId]);\n      }\n    } catch (error) {\n      console.error(\"Failed to group zones:\", error);\n    }\n  };\n\n  const handleUngroupZones = async () => {\n    // Ungroup by creating separate groups for each selected zone\n    // This is a simplified approach - in reality, we'd need to split the group\n    try {\n      await refreshState();\n    } catch (error) {\n      console.error(\"Failed to ungroup zones:\", error);\n    }\n  };\n\n  const handleMultiZoneControl = async (command: \"play\" | \"pause\" | \"skipToNextTrack\" | \"skipToPreviousTrack\") => {\n    // If only one zone is selected, or if zones are grouped, control the single group\n    // This ensures grouped zones play the same content synchronously\n    if (selectedZoneIds.length === 1 || selectedZoneIds.length === 0) {\n      const groupId = selectedZoneIds[0] || currentGroup?.id;\n      if (!groupId) return;\n      \n      const res = await fetch(`/api/sonos/control?groupId=${groupId}&command=${command}`, { method: \"POST\" });\n      if (res.status === 410) {\n        // Group no longer exists, refresh state\n        await refreshState();\n      } else if (res.ok) {\n        await refreshState();\n        setTimeout(() => refreshState(), 500);\n      }\n      return;\n    }\n\n    // If multiple zones are selected but NOT grouped, group them first\n    // This ensures they play the same content\n    if (selectedZoneIds.length > 1) {\n      // Group the zones first, then control the group\n      await handleGroupZones();\n      // After grouping, control will use the single grouped zone\n      const groupId = selectedZoneIds[0];\n      if (groupId) {\n        const res = await fetch(`/api/sonos/control?groupId=${groupId}&command=${command}`, { method: \"POST\" });\n        if (res.ok) {\n          await refreshState();\n          setTimeout(() => refreshState(), 500);\n        }\n      }\n    }\n  };\n\n  return (\n    <>\n      <motion.div \n        initial={{ y: 40, opacity: 0 }}\n        animate={{ y: 0, opacity: 1 }}\n        transition={{ delay: 0.8, duration: 1, ease: [0.22, 1, 0.36, 1] }}\n        onClick={() => setIsExpanded(true)}\n        className=\"h-28 glass-light rounded-[3rem] p-4 shadow-[0_40px_80px_-20px_rgba(0,0,0,0.4)] flex items-center justify-between gap-8 border border-white/10 group cursor-pointer hover:bg-white/10 dark:hover:bg-black/40 transition-all duration-700\"\n      >\n        {/* Track Info */}\n        <div className=\"flex items-center gap-6 w-[35%] min-w-0\">\n          <div className=\"h-20 w-20 rounded-[2rem] overflow-hidden flex-shrink-0 shadow-2xl relative group-hover:scale-105 transition-transform duration-700 border border-white/5 bg-secondary\">\n            {artwork ? (\n              <img src={artwork} alt={title} className=\"w-full h-full object-cover saturate-125\" />\n            ) : (\n              <div className=\"w-full h-full flex items-center justify-center\">\n                <Disc className=\"h-8 w-8 text-muted-foreground opacity-20 animate-spin-slow\" />\n              </div>\n            )}\n            {isPlaying && (\n              <div className=\"absolute inset-0 bg-black/20 backdrop-blur-[2px] flex items-center justify-center\">\n                <div className=\"flex gap-1.5 items-end h-6\">\n                  <motion.div animate={{ height: [4, 16, 8, 20, 4] }} transition={{ repeat: Infinity, duration: 1 }} className=\"w-1 bg-white rounded-full\" />\n                  <motion.div animate={{ height: [8, 4, 16, 4, 12] }} transition={{ repeat: Infinity, duration: 0.8 }} className=\"w-1 bg-white rounded-full\" />\n                  <motion.div animate={{ height: [12, 16, 4, 16, 8] }} transition={{ repeat: Infinity, duration: 1.2 }} className=\"w-1 bg-white rounded-full\" />\n                </div>\n              </div>\n            )}\n          </div>\n          <div className=\"flex flex-col min-w-0\">\n            <span className=\"font-black text-[22px] tracking-tighter truncate uppercase italic leading-none mb-1.5\">{title}</span>\n            <div className=\"flex items-center gap-3\">\n              <span className=\"text-[10px] font-black uppercase tracking-[0.2em] text-primary opacity-90 dark:opacity-80\">Artist</span>\n              <span className=\"text-[13px] font-bold text-muted-foreground truncate uppercase tracking-widest opacity-70 dark:opacity-60\">{artist}</span>\n            </div>\n          </div>\n        </div>\n\n        {/* Playback Controls */}\n        <div className=\"flex items-center gap-10\">\n          <Button \n            variant=\"ghost\" \n            size=\"icon\" \n            className=\"h-14 w-14 text-muted-foreground hover:text-foreground transition-all group/btn\"\n            onClick={(e) => skip(e, \"skipToPreviousTrack\")}\n          >\n            <SkipBack className=\"h-8 w-8 fill-current transition-transform group-active/btn:scale-90\" />\n          </Button>\n          \n          <Button \n            variant=\"default\" \n            size=\"icon\" \n            className=\"h-20 w-20 rounded-[2rem] bg-foreground text-background hover:scale-105 active:scale-90 transition-all shadow-[0_20px_40px_-8px_rgba(0,0,0,0.3)] dark:shadow-primary/20 border-4 border-white/5\" \n            onClick={togglePlayback}\n          >\n            {isPlaying ? <Pause className=\"h-10 w-10 fill-current\" /> : <Play className=\"h-10 w-10 fill-current ml-1.5\" />}\n          </Button>\n          \n          <Button \n            variant=\"ghost\" \n            size=\"icon\" \n            className=\"h-14 w-14 text-muted-foreground hover:text-foreground transition-all group/btn\"\n            onClick={(e) => skip(e, \"skipToNextTrack\")}\n          >\n            <SkipForward className=\"h-8 w-8 fill-current transition-transform group-active/btn:scale-90\" />\n          </Button>\n        </div>\n\n        {/* High-End Actions */}\n        <div className=\"flex items-center justify-end gap-8 w-[35%]\">\n          <div className=\"hidden xl:flex items-center gap-3 pr-4\" onClick={(e) => e.stopPropagation()}>\n            <VolumeControl\n              selectedZoneIds={selectedZoneIds.length > 0 ? selectedZoneIds : (currentGroup ? [currentGroup.id] : [])}\n              compact={true}\n            />\n            <ZoneSelector\n              selectedZoneIds={selectedZoneIds}\n              onZoneToggle={toggleZone}\n              onGroupZones={handleGroupZones}\n              onUngroupZones={handleUngroupZones}\n              compact={true}\n            />\n            <Button \n              variant=\"ghost\" \n              size=\"icon\" \n              onClick={async (e) => {\n                e.stopPropagation();\n                if (!currentGroup) return;\n                const newShuffle = !shuffleEnabled;\n                setShuffleEnabled(newShuffle);\n                try {\n                  const res = await fetch(`/api/sonos/control?groupId=${currentGroup.id}&shuffle=${newShuffle}`, { method: \"POST\" });\n                  if (res.ok) {\n                    await refreshState();\n                  } else {\n                    setShuffleEnabled(!newShuffle);\n                  }\n                } catch (error) {\n                  console.error(\"Failed to toggle shuffle:\", error);\n                  setShuffleEnabled(!newShuffle);\n                }\n              }}\n              className={cn(\n                \"h-14 w-14 rounded-[1.75rem] glass transition-all\",\n                shuffleEnabled \n                  ? \"bg-primary/20 text-primary\" \n                  : \"hover:bg-primary/10 text-muted-foreground\"\n              )}\n            >\n              <Shuffle className=\"h-6 w-6\" />\n            </Button>\n            <Button \n              variant=\"ghost\" \n              size=\"icon\" \n              onClick={async (e) => {\n                e.stopPropagation();\n                if (!currentGroup) return;\n                const newRepeat = !repeatEnabled;\n                setRepeatEnabled(newRepeat);\n                try {\n                  const res = await fetch(`/api/sonos/control?groupId=${currentGroup.id}&repeat=${newRepeat}`, { method: \"POST\" });\n                  if (res.ok) {\n                    await refreshState();\n                  } else {\n                    setRepeatEnabled(!newRepeat);\n                  }\n                } catch (error) {\n                  console.error(\"Failed to toggle repeat:\", error);\n                  setRepeatEnabled(!newRepeat);\n                }\n              }}\n              className={cn(\n                \"h-14 w-14 rounded-[1.75rem] glass transition-all\",\n                repeatEnabled \n                  ? \"bg-primary/20 text-primary\" \n                  : \"hover:bg-primary/10 text-muted-foreground\"\n              )}\n            >\n              <Repeat className=\"h-6 w-6\" />\n            </Button>\n            <Button \n              variant=\"secondary\" \n              size=\"icon\" \n              className=\"h-14 w-14 rounded-[1.75rem] bg-primary text-primary-foreground hover:scale-105 transition-all shadow-lg\"\n              onClick={(e) => { e.stopPropagation(); setIsExpanded(true); }}\n            >\n              <Maximize2 className=\"h-6 w-6\" />\n            </Button>\n          </div>\n        </div>\n      </motion.div>\n\n      <AnimatePresence>\n        {isExpanded && (\n          <FullScreenPlayer onClose={() => setIsExpanded(false)} />\n        )}\n      </AnimatePresence>\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6183, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/components/dashboard.tsx"],"sourcesContent":["\"use client\";\n\nimport { useSonos } from \"@/components/sonos-provider\";\nimport { useDevice } from \"@/components/device-provider\";\nimport { ZoneSelector } from \"./dashboard/zone-selector\";\nimport { FavoriteGrid } from \"./dashboard/favorite-grid\";\nimport { LibraryPage } from \"./dashboard/library-page\";\nimport { SettingsPage } from \"./dashboard/settings-page\";\nimport { MiniPlayer } from \"./player/mini-player\";\nimport { Settings, Moon, Sun, Menu, X, Command } from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { cn } from \"@/lib/utils\";\n\nexport function Dashboard() {\n  const { currentGroup, isExpanded, currentPage, setCurrentPage } = useSonos();\n  const { deviceType } = useDevice();\n  const [isDarkMode, setIsDarkMode] = useState(true);\n  const [isSidebarOpen, setIsSidebarOpen] = useState(true);\n  \n  // Device-specific responsive adjustments\n  // Both devices are 1280800, so we optimize for that resolution\n  const isDeviceMode = deviceType !== null;\n\n  // Load theme from localStorage on mount\n  useEffect(() => {\n    const savedTheme = localStorage.getItem(\"theme\");\n    if (savedTheme !== null) {\n      const isDark = savedTheme === \"dark\";\n      setIsDarkMode(isDark);\n      if (isDark) {\n        document.documentElement.classList.add(\"dark\");\n      } else {\n        document.documentElement.classList.remove(\"dark\");\n      }\n    } else {\n      // Default to dark mode if no preference saved\n      setIsDarkMode(true);\n      document.documentElement.classList.add(\"dark\");\n    }\n  }, []);\n\n  // Save theme to localStorage and update DOM when theme changes\n  useEffect(() => {\n    if (isDarkMode) {\n      document.documentElement.classList.add(\"dark\");\n      localStorage.setItem(\"theme\", \"dark\");\n    } else {\n      document.documentElement.classList.remove(\"dark\");\n      localStorage.setItem(\"theme\", \"light\");\n    }\n  }, [isDarkMode]);\n\n  return (\n    <div className={cn(\n      \"flex h-screen bg-background text-foreground transition-colors duration-1000 overflow-hidden font-sans\",\n      isDeviceMode && \"device-responsive\"\n    )}>\n      {/* Subtle Background Textures */}\n      <div className=\"fixed inset-0 z-0 pointer-events-none overflow-hidden\">\n        <div className=\"absolute top-[-10%] left-[-5%] w-[50%] h-[50%] bg-primary/5 blur-[150px] rounded-full\" />\n        <div className=\"absolute bottom-[-10%] right-[-5%] w-[40%] h-[40%] bg-foreground/3 blur-[120px] rounded-full\" />\n      </div>\n\n      <AnimatePresence>\n        {isSidebarOpen && !isExpanded && (\n          <motion.aside\n            initial={{ x: -320, opacity: 0 }}\n            animate={{ x: 0, opacity: 1 }}\n            exit={{ x: -320, opacity: 0 }}\n            transition={{ type: \"spring\", damping: 35, stiffness: 250 }}\n            className=\"fixed lg:relative z-50 h-full w-[300px] flex flex-col border-r border-foreground/[0.03]\"\n          >\n            {/* Minimalist Logo */}\n            <div className=\"p-10 pb-6 shrink-0\">\n              <div className=\"flex items-center gap-3 group cursor-pointer\">\n                <div className=\"h-10 w-10 rounded-full bg-foreground flex items-center justify-center transition-all duration-500 group-hover:scale-110 shadow-lg\">\n                  <Command className=\"text-background h-5 w-5\" />\n                </div>\n                <span className=\"text-lg font-black tracking-[0.2em] uppercase italic opacity-90 leading-none\">Stream</span>\n              </div>\n            </div>\n\n            {/* Navigation & Rooms */}\n            <div className=\"flex-1 overflow-y-auto no-scrollbar py-6\">\n              <ZoneSelector isCollapsed={false} />\n            </div>\n\n            {/* Simple Controls Footer */}\n            <div className=\"p-10 shrink-0 space-y-6\">\n              <button \n                onClick={() => setIsDarkMode(!isDarkMode)}\n                className=\"w-full h-12 rounded-full border border-foreground/[0.05] hover:bg-foreground/[0.03] flex items-center justify-between px-6 transition-all duration-300 group\"\n              >\n                <span className=\"text-[10px] font-black uppercase tracking-[0.3em] text-muted-foreground group-hover:text-foreground transition-colors\">\n                  {isDarkMode ? \"Night\" : \"Day\"}\n                </span>\n                <div className=\"relative h-4 w-4\">\n                  <Sun className={cn(\"absolute inset-0 h-4 w-4 transition-all duration-700\", isDarkMode ? \"scale-0 rotate-90\" : \"scale-100 rotate-0 text-amber-500\")} />\n                  <Moon className={cn(\"absolute inset-0 h-4 w-4 transition-all duration-700\", isDarkMode ? \"scale-100 rotate-0 text-foreground\" : \"scale-0 -rotate-90\")} />\n                </div>\n              </button>\n              \n              <div className=\"flex justify-center\">\n                <p className=\"text-[8px] font-black uppercase tracking-[0.5em] text-muted-foreground opacity-60 dark:opacity-40 italic\">V 1.0 Architectural</p>\n              </div>\n            </div>\n          </motion.aside>\n        )}\n      </AnimatePresence>\n\n      <main className=\"flex-1 flex flex-col h-full relative z-10 overflow-hidden\">\n        {/* Editorial Header */}\n        {!isExpanded && (\n          <header className=\"h-32 px-12 lg:px-20 flex items-center justify-between shrink-0\">\n            <div className=\"flex items-center gap-10\">\n              <button \n                onClick={() => setIsSidebarOpen(!isSidebarOpen)}\n                className=\"h-10 w-10 rounded-full border border-foreground/[0.05] hover:bg-foreground/[0.03] flex items-center justify-center transition-all group relative overflow-hidden\"\n              >\n                <Menu className={cn(\"h-4 w-4 transition-transform duration-500\", isSidebarOpen ? \"translate-y-10 scale-0\" : \"translate-y-0 scale-100\")} />\n                <X className={cn(\"absolute h-4 w-4 transition-transform duration-500\", isSidebarOpen ? \"translate-y-0 scale-100\" : \"-translate-y-10 scale-0\")} />\n              </button>\n              \n              <AnimatePresence mode=\"wait\">\n                <motion.div\n                  key={currentGroup?.id || \"empty\"}\n                  initial={{ opacity: 0, y: 10 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  exit={{ opacity: 0, y: -10 }}\n                  className=\"space-y-0.5\"\n                >\n                  <p className=\"text-[9px] font-black uppercase tracking-[0.6em] text-primary opacity-70 dark:opacity-60\">Environment</p>\n                  <h2 className=\"text-4xl lg:text-5xl font-black tracking-tighter italic uppercase leading-none text-foreground\">\n                    {currentGroup?.name || \"Lobby\"}\n                  </h2>\n                </motion.div>\n              </AnimatePresence>\n            </div>\n\n            <div className=\"hidden md:flex items-center gap-8\">\n              <div className=\"flex gap-4\">\n                <button \n                  onClick={() => setCurrentPage(\"Settings\")}\n                  className={cn(\n                    \"h-10 w-10 rounded-full border border-foreground/[0.05] hover:bg-foreground/[0.03] flex items-center justify-center transition-all\",\n                    currentPage === \"Settings\" ? \"text-foreground bg-foreground/[0.05]\" : \"text-muted-foreground hover:text-foreground\"\n                  )}\n                >\n                  <Settings className=\"h-4 w-4\" />\n                </button>\n              </div>\n            </div>\n          </header>\n        )}\n\n        {/* Cinematic Gallery Grid */}\n        <section className={cn(\n          \"flex-1 overflow-y-auto no-scrollbar pt-4 pb-48\",\n          !isExpanded \n            ? (isDeviceMode ? \"px-8\" : \"px-12 lg:px-20\")\n            : \"px-0\"\n        )}>\n          {!isExpanded && (\n            <>\n              {currentPage === \"Feed\" && <FavoriteGrid />}\n              {currentPage === \"Library\" && <LibraryPage />}\n              {currentPage === \"Settings\" && <SettingsPage />}\n              {currentPage === \"Broadcast\" && (\n                <div className=\"flex items-center justify-center h-full\">\n                  <p className=\"text-muted-foreground uppercase tracking-widest\">Broadcast Coming Soon</p>\n                </div>\n              )}\n              {currentPage === \"Curated\" && (\n                <div className=\"flex items-center justify-center h-full\">\n                  <p className=\"text-muted-foreground uppercase tracking-widest\">Curated Coming Soon</p>\n                </div>\n              )}\n            </>\n          )}\n        </section>\n\n        {/* Floating Controller Hub */}\n        {currentPage !== \"Settings\" && (\n          <div className={cn(\n            \"absolute bottom-12 left-0 right-0 pointer-events-none\",\n            isDeviceMode ? \"px-8\" : \"px-12 lg:px-20\"\n          )}>\n            <div className=\"max-w-6xl mx-auto pointer-events-auto\">\n              <MiniPlayer />\n            </div>\n          </div>\n        )}\n      </main>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6658, "column": 0}, "map": {"version":3,"sources":["file:///Users/ollie/Documents/dev/musicStreamer/src/components/spotify-callback-handler.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect } from \"react\";\nimport { useSearchParams, useRouter } from \"next/navigation\";\nimport { useSonos } from \"@/components/sonos-provider\";\n\nexport function SpotifyCallbackHandler() {\n  const searchParams = useSearchParams();\n  const router = useRouter();\n  const { setCurrentPage } = useSonos();\n\n  useEffect(() => {\n    const spotifyConnected = searchParams.get(\"spotify_connected\");\n    const error = searchParams.get(\"error\");\n\n    if (spotifyConnected === \"true\") {\n      // Redirect to Settings page after successful connection\n      setCurrentPage(\"Settings\");\n      // Remove query params from URL\n      router.replace(\"/\");\n    } else if (error) {\n      // Show error, redirect to Settings\n      setCurrentPage(\"Settings\");\n      router.replace(\"/\");\n    }\n  }, [searchParams, router, setCurrentPage]);\n\n  return null;\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAJA;;;;AAMO,SAAS;IACd,MAAM,eAAe,IAAA,qJAAe;IACpC,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,EAAE,cAAc,EAAE,GAAG,IAAA,mJAAQ;IAEnC,IAAA,kNAAS,EAAC;QACR,MAAM,mBAAmB,aAAa,GAAG,CAAC;QAC1C,MAAM,QAAQ,aAAa,GAAG,CAAC;QAE/B,IAAI,qBAAqB,QAAQ;YAC/B,wDAAwD;YACxD,eAAe;YACf,+BAA+B;YAC/B,OAAO,OAAO,CAAC;QACjB,OAAO,IAAI,OAAO;YAChB,mCAAmC;YACnC,eAAe;YACf,OAAO,OAAO,CAAC;QACjB;IACF,GAAG;QAAC;QAAc;QAAQ;KAAe;IAEzC,OAAO;AACT"}}]
}